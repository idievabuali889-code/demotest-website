(()=>{(()=>{let da=!1;const Ta=()=>{const w=window.SUPABASE_PUBLIC_CONFIG||{},T=w.url||"",le=w.anonKey||"";if(!T||!le||!window.supabase)return null;try{return window.supabase.createClient(T,le)}catch(J){return console.error("Failed to init Supabase client for auth",J),null}},ma=async w=>{try{const{data:T,error:le}=await w.rpc("is_owner");if(le)throw le;return!!T}catch(T){return console.error("Owner check failed",T),null}},ua=()=>{if(da)return;da=!0;const{useState:w,useEffect:T,useRef:le,useMemo:J,useLayoutEffect:gt}=React,Ht="Odil Accessories",xt="Simple wholesale catalogue with WhatsApp ordering.",Oe="GBP",zt="\xA3",Re="992935563306",De="nova_wholesale_cart_v1",Ge="nova_owner_products_v1",at=document.body.dataset.layout==="owner",ct=at||document.body.dataset.ownerMode!=="disabled",Ke=ct&&!at,qt=at||document.body.dataset.defaultOwner==="true",ht="/.netlify/functions/catalogue",St=Oe,X="__base__",He="__prices",Wa=(a,r)=>{const t=(a||r||"").trim();if(!t)return r||"";const o=t.toLowerCase();return o.includes("color")||o.includes("colour")?"Color":r==="models"||o.includes("model")?"Model":t.replace(/\s+/g," ").trim()},Fe=(a={})=>{const r=Object.entries(a||{}).filter(([t,o])=>o!=null&&String(o).trim()!=="");return r.length?r.sort(([t],[o])=>t.localeCompare(o)).map(([t,o])=>`${t}:${o}`).join("|"):X},ze=a=>{if(!a||typeof a!="object")return{};const r={};return Object.entries(a).forEach(([t,o])=>{const n=Number(o);Number.isFinite(n)&&n>=0&&(r[t&&t.trim()||X]=n)}),r},ba=a=>{const r=Object.entries(a||{}).filter(([n,u])=>Array.isArray(u)&&u.length);if(!r.length)return[{key:X,selection:{}}];const t=[],o=(n,u)=>{if(n>=r.length){const g=Fe(u);t.push({key:g,selection:{...u}});return}const[i,E]=r[n];E.forEach(g=>o(n+1,{...u,[i]:g}))};return o(0,{}),t},Gr=(a,r)=>{const t=[...r.must||[],...r.also||[],...r.optional||[]],o={};return t.forEach(n=>{const u=a[n.key],i=Wa(n.label,n.key);if(n.type==="checkbox"){u&&(o[i]=["Yes"]);return}if(u==null)return;if(Array.isArray(u)){const g=u.map(h=>String(h).trim()).filter(Boolean);g.length&&(o[i]=Array.from(new Set(g)));return}const E=String(u).trim();E&&(o[i]=[E])}),o},pa=window.SUPABASE_PUBLIC_CONFIG||{},Yt=pa.url||"",fa=pa.anonKey||"",Da=!!(Yt&&fa);let Pe=null;try{window.supabase&&Da?(Pe=window.supabase.createClient(Yt,fa),console.log("\u2705 Supabase client initialized successfully"),console.log("\u{1F4CD} Supabase URL:",Yt),setTimeout(async()=>{try{console.log("\u{1F504} Testing database connection...");const{data:r,error:t}=await Pe.from("products").select("count").limit(1);t?(console.error("\u274C Database test failed:",t),t.message.includes("permission denied")&&console.error("\u{1F6AB} RLS Policy Issue: Run the SQL script to fix permissions"),t.message.includes('relation "products" does not exist')&&console.error("\u{1F3D7}\uFE0F Table Missing: Run the SQL script to create the products table")):console.log("\u2705 Database connection successful"),console.log("\u{1F504} Testing realtime connection...");const o=Pe.channel("test-channel");o.subscribe(n=>{n==="SUBSCRIBED"?(console.log("\u2705 Realtime connection successful"),o.unsubscribe()):n==="CHANNEL_ERROR"&&console.error("\u274C Realtime connection failed")})}catch(r){console.error("\u274C Connection test failed:",r)}},1e3)):console.warn("\u26A0\uFE0F Supabase not initialized - supply SUPABASE_PUBLIC_CONFIG in supabase-config.js")}catch(a){console.error("\u274C Supabase initialization failed:",a)}const Vt=async(a,r=3,t=1e3)=>{for(let o=1;o<=r;o++)try{return await a()}catch(n){if(console.warn(`\u26A0\uFE0F Attempt ${o}/${r} failed:`,n.message),o===r)throw n;await new Promise(u=>setTimeout(u,t*o))}},$a=async()=>{var a;try{if(!Pe)return null;const{data:r}=await Pe.auth.getSession(),t=(a=r==null?void 0:r.session)==null?void 0:a.access_token;return t?`Bearer ${t}`:null}catch(r){return null}},dt=async(a,r)=>{try{const t=await $a(),o=await fetch(ht,{method:"POST",headers:{"Content-Type":"application/json",...t?{Authorization:t}:{}},body:JSON.stringify({action:a,data:r})});if(!o.ok){const u=await o.text().catch(()=>"");throw new Error(`Owner API ${a} failed: ${o.status} ${u}`)}const n=await o.json().catch(()=>({}));if(n!=null&&n.error){const u=new Error(n.error.message||n.error);throw u.details=n.error.details,u.hint=n.error.hint,u.code=n.error.code,u}return n}catch(t){throw console.error(`Owner API ${a} error`,t),t}},ye=a=>{var H;if(!a)return null;const{sourceid:r,sourceId:t,images:o,image:n,specs:u,variants:i,inventory:E,price:g,hidden:h,...d}=a,x=(H=t!=null?t:r)!=null?H:null,c=$=>Array.isArray($)?$:$==null?[]:typeof $=="string"&&$.trim().length?[$]:[],m=c(o),M=c(u),W=typeof i=="object"&&i!==null&&!Array.isArray(i)?i:{},_=ze(E),B=n||m[0]||void 0,G=m.length?m:B?[B]:[];return{...d,sourceId:x,images:G,specs:M,variants:W,inventory:_,price:typeof g=="number"?g:Number(g)||0,hidden:!!h,image:B}},ya=a=>{var n;const r={id:a.id,name:a.name,sku:a.sku,category:a.category,price:Number(a.price)||0,description:(n=a.description)!=null?n:""},t=Array.isArray(a.images)?a.images:a.image?[a.image]:[];r.images=t,r.specs=Array.isArray(a.specs)?a.specs:[],r.variants=a.variants&&typeof a.variants=="object"&&!Array.isArray(a.variants)?a.variants:{},a.sourceId&&(r.sourceid=a.sourceId),a.hidden&&(r.hidden=!0);const o=ze(a.inventory);return r.inventory=o,r},ga=async()=>{if(!Pe)return console.warn("\u26A0\uFE0F Cannot load products: Supabase not initialized"),[];try{console.log("\u{1F504} Loading products from database...");const{data:a,error:r}=await Pe.from("products").select("*").order("created_at",{ascending:!1});if(r)throw console.error("\u274C Database error:",r),r;return console.log(`\u2705 Loaded ${(a==null?void 0:a.length)||0} products from database`),(a||[]).map(ye).filter(Boolean)}catch(a){return console.error("Failed to load products:",a),[]}},Ua=async a=>{try{const r=ya(a),{data:t}=await Vt(()=>dt("insert",r)),o=ye(t);return console.log("\u2705 Product saved successfully:",o),o}catch(r){return console.error("\u274C Failed to save product after retries:",r),null}},Qt=async a=>{try{const r=ya(a),{data:t}=await Vt(()=>dt("upsert",r));return ye(t)}catch(r){return console.error("Failed to upsert product:",r),null}},Ga=async a=>{try{return await Vt(()=>dt("delete",{id:a})),!0}catch(r){return console.error("Failed to delete product:",r),!1}},Kr=a=>{if(!Pe)return null;try{return Pe.channel("products").on("postgres_changes",{event:"*",schema:"public",table:"products"},a).subscribe()}catch(r){return console.error("Failed to subscribe to product changes:",r),null}},At=["All","Phone Screens","Back Glass","Power Banks","Screen Protectors","Batteries","Mobile Phones","Tablets","Phone Cases","Cables","Chargers","Earphones","Charging Ports","Face ID"],rt=["iPhone 11","iPhone 12","iPhone 12 Pro","iPhone 13","iPhone 13 Pro","iPhone 14","iPhone 14 Pro","iPhone 15","iPhone 15 Plus","iPhone 15 Pro","iPhone 15 Pro Max","iPhone 16","iPhone 16 Pro","iPhone 16 Pro Max"],xa=["Galaxy S20","Galaxy S21","Galaxy S22","Galaxy S23","Galaxy S24","Galaxy S25"],Hr=[...rt,...xa],Ct=["Galaxy S20","Galaxy S21","Galaxy S22","Galaxy S23","Galaxy S24","Galaxy S25"],Ot=["Galaxy A14","Galaxy A24","Galaxy A34","Galaxy A54","Galaxy A55","Galaxy A15"],zr=["iPhone","Samsung S","Samsung A"],qr={iPhone:rt,"Samsung S":Ct,"Samsung A":Ot},Pt="__catalog_config__",ha="__",vt="__family:",Ka=a=>(Array.isArray(a)?a:[]).filter(r=>{const t=String(r||"");return t&&!t.startsWith(ha)}),va=a=>{const t=(Array.isArray(a==null?void 0:a.specs)?a.specs:[]).find(o=>typeof o=="string"&&o.startsWith(vt));return t?String(t).slice(vt.length).trim():""},Jt=(a,r)=>{var o,n;if(r==="models")return"Model";const t=String((o=a!=null?a:r)!=null?o:"").toLowerCase().trim();return t==="color"||t==="colors"||t==="colour"?"Color":t==="model"||t==="models"?"Model":String((n=a!=null?a:r)!=null?n:"").trim()},Zt=()=>({version:1,categories:At.filter(a=>a!=="All"),families:[{id:"iphone",name:"iPhone",models:[...rt]},{id:"samsung_s",name:"Samsung S",models:[...Ct]},{id:"samsung_a",name:"Samsung A",models:[...Ot]},{id:"accessories",name:"Accessories",models:[]}],groupsByCategory:{},groupOverridesByCategoryFamily:{},groupHiddenByCategoryFamily:{}}),Bt=a=>{const r=Zt();if(!a||typeof a!="object")return r;const t={...r,...a};return t.categories=Array.isArray(t.categories)?t.categories.filter(Boolean):r.categories,t.families=Array.isArray(t.families)?t.families.filter(Boolean):r.families,t.groupsByCategory=t.groupsByCategory&&typeof t.groupsByCategory=="object"?t.groupsByCategory:{},t.groupOverridesByCategoryFamily=t.groupOverridesByCategoryFamily&&typeof t.groupOverridesByCategoryFamily=="object"?t.groupOverridesByCategoryFamily:{},t.groupHiddenByCategoryFamily=t.groupHiddenByCategoryFamily&&typeof t.groupHiddenByCategoryFamily=="object"?t.groupHiddenByCategoryFamily:{},t},wa=["Original","OEM","AAA","Aftermarket","Refurb"],Ha=["TPU","Silicone","PC","Leather"],wt=["Black","White","Navy","Clear","Red","Lavender","Stone","Midnight","Starlight","Blue","Green","Gold"],_t={Black:"#111827",White:"#ffffff",Navy:"#1e3a8a",Clear:"#ffffff",Red:"#ef4444",Lavender:"#b57edc",Stone:"#a8a29e",Midnight:"#0f172a",Starlight:"#f8fafc",Blue:"#3b82f6",Green:"#10b981",Gold:"#f59e0b"};function st({name:a}){const r=_t[a],t=r?{backgroundColor:r,border:"1px solid rgba(0,0,0,.15)"}:{backgroundImage:"linear-gradient(45deg,#e5e7eb 25%,transparent 25%),linear-gradient(-45deg,#e5e7eb 25%,transparent 25%),linear-gradient(45deg,transparent 75%,#e5e7eb 75%),linear-gradient(-45deg,transparent 75%,#e5e7eb 75%)",backgroundSize:"8px 8px",border:"1px solid rgba(0,0,0,.15)"};return React.createElement("span",{"aria-hidden":"true",className:"inline-block h-3 w-3 rounded-full align-[-2px]",style:t})}const za=["Tempered","Hydrogel"],qa=["Clear","Matte","Privacy"],Ya=["1-Pack","2-Pack"],Va=["Edge-to-edge","Full glue"],Xt=["USB-C \u2194 USB-C","USB-C \u2194 Lightning","USB-A \u2194 Micro-USB"],Ea=["0.5m","1m","2m"],Na=["27W","60W","100W"],Qa=["MFi","USB-IF"],Ja=["Standard","Braided",">10k bends"],Za=["20W","30W","45W","65W"],Ra=["1\xD7USB-C","1\xD7USB-A","1\xD7USB-C + 1\xD7USB-A","2\xD7USB-C"],mt=["PD 3.0","PPS","QC 3.0","QC 4+"],Yr=["CE","UKCA"],Xa=["UK 3-pin","EU","US"],ka=["New","Refurb","Used A","Used B"],er=["Unlocked","Locked","Dual-SIM Yes","Dual-SIM No"],tr=["5G","4G"],ar=["Wi-Fi","Wi-Fi + Cellular"],Sa=["32GB","64GB","128GB","256GB","512GB","1TB"],Aa=["3GB","4GB","6GB","8GB","12GB","16GB"],Vr=Xt,rr=Ea,Qr=Na,sr=["10,000 mAh","20,000 mAh"],Ca=["open","confirmed","shipped"],nr=["open","confirmed","shipped","cancelled"],Mt={open:"Open",confirmed:"Confirmed",shipped:"Shipped",cancelled:"Cancelled"},or=[{id:"sp-iph-13-tmp-2pk",name:"Tempered Glass \u2013 iPhone 13 (2\u2011Pack)",sku:"SP-IP13-TG2",category:"Screen Protectors",price:3.2,specs:["2\u2011Pack","Tempered","9H","Oleophobic"],description:"Clear tempered glass for iPhone 13.",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.07_b6d5696d.jpg",variants:{Model:["iPhone 13"],Material:["Tempered"],Pack:["2\u2011Pack"]}},{id:"sp-iph-14-hg-1pk",name:"Hydrogel Protector \u2013 iPhone 14",sku:"SP-IP14-HG1",category:"Screen Protectors",price:2.6,specs:["Hydrogel","Self\u2011healing","Case\u2011friendly"],description:"Flexible hydrogel film.",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.08_46a12f36.jpg",variants:{Model:["iPhone 14"],Material:["Hydrogel"],Pack:["1\u2011Pack","2\u2011Pack"]}},{id:"case-slim-tpu-iph-11-16",name:"Slim TPU Case \u2013 iPhone Series",sku:"CA-IP-TPU",category:"Phone Cases",price:3.9,specs:["TPU","Slim","Matte"],description:"Slim matte TPU case.",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.09_811264ed.jpg",variants:{Color:["Black","Navy","Clear","Red"],Material:["TPU"],Model:rt}},{id:"case-silicone-sg-s20-s25",name:"Soft Silicone Case \u2013 Galaxy Series",sku:"CA-SG-SIL",category:"Phone Cases",price:4.1,specs:["Silicone","Microfiber"],description:"Soft\u2011touch silicone for Galaxy.",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.10_3d78676b.jpg",variants:{Color:["Midnight","Stone","Lavender"],Material:["Silicone"],Model:xa}},{id:"chg-65w-gan-dual",name:"65W GaN Charger \u2013 Dual Port",sku:"CH-65W-GAN",category:"Chargers",price:12.5,specs:["65W","USB\u2011C + USB\u2011A","PD/QC"],description:"Compact GaN charger.",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.11_89070b32.jpg",variants:{Wattage:["65W"],Ports:["USB\u2011C + USB\u2011A"],Standard:mt}},{id:"chg-20w-usbc",name:"20W USB\u2011C Wall Charger",sku:"CH-20W-USBC",category:"Chargers",price:6,specs:["20W","USB\u2011C","PD"],description:"USB\u2011C PD charger.",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.11_9ebc1ea2.jpg",variants:{Wattage:["20W"],Ports:["USB\u2011C"],Standard:["PD 3.0"]}},{id:"cbl-usbc-60w-1m-2m",name:"USB\u2011C Cable 60W",sku:"CB-UC-60",category:"Cables",price:2.2,specs:["USB\u2011C","60W","Nylon"],description:"Braided 60W cable.",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.12_628fcab2.jpg",variants:{Connector:["USB\u2011C \u2194 USB\u2011C"],Length:rr,Rating:["60W"]}},{id:"cbl-lightning-mfi",name:"Lightning Cable (MFi)",sku:"CB-LT-MFI",category:"Cables",price:3.5,specs:["Lightning","MFi","1m"],description:"MFi Lightning cable.",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.13_22d8e7c9.jpg",variants:{Connector:["USB\u2011C \u2194 Lightning"],Length:["1m"],Rating:["27W"]}},{id:"ear-wired-classic",name:"Wired Earphones \u2013 Classic",sku:"EA-WI-CLS",category:"Earphones",price:4.2,specs:["3.5mm","In\u2011line mic"],description:"Wired earphones.",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.14_4f407f9a.jpg",variants:{Connector:["3.5mm"],Color:["Black","White"]}},{id:"ear-tws-basic",name:"TWS Earbuds \u2013 Basic",sku:"EA-TWS-BSC",category:"Earphones",price:12.9,specs:["BT 5.3","20h"],description:"TWS earbuds.",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.15_e7b8adc0.jpg",variants:{Color:["White","Black"],Standard:["BT 5.3"]}},{id:"pb-10000-compact",name:"Power Bank 10,000 mAh",sku:"PB-10K-CMP",category:"Power Banks",price:11,specs:["10,000 mAh","USB\u2011C","PD"],description:"Slim 10k power bank.",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.17_01d0dcae.jpg",variants:{Capacity:["10,000 mAh"],Ports:["USB\u2011C","USB\u2011A"],Standard:mt}},{id:"pb-20000-dual",name:"Power Bank 20,000 mAh \u2013 Dual",sku:"PB-20K-DUAL",category:"Power Banks",price:16.5,specs:["20,000 mAh","Dual","PD/QC"],description:"20k dual output.",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.19_3b58c17b.jpg",variants:{Capacity:["20,000 mAh"],Ports:["USB\u2011C + USB\u2011A"],Standard:mt}},{id:"img-001",name:"Accessory Photo A",sku:"IM-001",category:"Phone Cases",price:2.5,specs:["Assorted"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.33_5dd08e33.jpg"},{id:"img-002",name:"Accessory Photo B",sku:"IM-002",category:"Chargers",price:7.2,specs:["Fast"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.34_09a1e9d9.jpg"},{id:"img-003",name:"Accessory Photo C",sku:"IM-003",category:"Cables",price:1.8,specs:["1m"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.34_f1935767.jpg"},{id:"img-004",name:"Accessory Photo D",sku:"IM-004",category:"Screen Protectors",price:2.9,specs:["Tempered"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.35_92866963.jpg"},{id:"img-005",name:"Accessory Photo E",sku:"IM-005",category:"Phone Cases",price:3.6,specs:["TPU"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.36_d9ee268e.jpg"},{id:"img-006",name:"Accessory Photo F",sku:"IM-006",category:"Back Glass",price:5.5,specs:["Glass"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.37_ef5ed98e.jpg"},{id:"img-007",name:"Accessory Photo G",sku:"IM-007",category:"Earphones",price:6,specs:["Wireless"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.38_b444897c.jpg"},{id:"img-008",name:"Accessory Photo H",sku:"IM-008",category:"Power Banks",price:9.9,specs:["10k"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.38_f170faf6.jpg"},{id:"img-009",name:"Accessory Photo I",sku:"IM-009",category:"Cables",price:2,specs:["2m"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.39_c37cddc9.jpg"},{id:"img-010",name:"Accessory Photo J",sku:"IM-010",category:"Chargers",price:11.5,specs:["65W"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.40_7a858ba3.jpg"},{id:"img-011",name:"Accessory Photo K",sku:"IM-011",category:"Phone Cases",price:4.4,specs:["Silicone"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.41_80d08b54.jpg"},{id:"img-012",name:"Accessory Photo L",sku:"IM-012",category:"Screen Protectors",price:1.9,specs:["Hydrogel"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.41_a2efd2e1.jpg"},{id:"img-013",name:"Accessory Photo M",sku:"IM-013",category:"Back Glass",price:6.5,specs:["Back glass"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.42_63c16e8a.jpg"},{id:"img-014",name:"Accessory Photo N",sku:"IM-014",category:"Batteries",price:8,specs:["OEM"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.43_06e00e31.jpg"},{id:"img-015",name:"Accessory Photo O",sku:"IM-015",category:"Phone Cases",price:3.2,specs:["Clear"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.44_de3a612b.jpg"},{id:"img-016",name:"Accessory Photo P",sku:"IM-016",category:"Cables",price:2.4,specs:["Nylon"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.44_fddf905d.jpg"},{id:"img-017",name:"Accessory Photo Q",sku:"IM-017",category:"Earphones",price:5,specs:["Wired"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.45_b1dd7f8a.jpg"},{id:"img-018",name:"Accessory Photo R",sku:"IM-018",category:"Chargers",price:9.5,specs:["30W"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.46_30024620.jpg"},{id:"img-019",name:"Accessory Photo S",sku:"IM-019",category:"Power Banks",price:14,specs:["20k"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.46_cb602f30.jpg"},{id:"img-020",name:"Accessory Photo T",sku:"IM-020",category:"Phone Cases",price:3.8,specs:["Leather"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.46_d9e5908c.jpg"},{id:"img-021",name:"Accessory Photo U",sku:"IM-021",category:"Screen Protectors",price:2.7,specs:["Matte"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.47_ac758901.jpg"},{id:"img-022",name:"Accessory Photo V",sku:"IM-022",category:"Cables",price:1.6,specs:["0.5m"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.48_bc4af4ef.jpg"},{id:"img-023",name:"Accessory Photo W",sku:"IM-023",category:"Chargers",price:4.9,specs:["USB\u2011A"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.48_f4496fba.jpg"},{id:"img-024",name:"Accessory Photo X",sku:"IM-024",category:"Earphones",price:13.5,specs:["TWS"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.49_ad6d3003.jpg"},{id:"img-025",name:"Accessory Photo Y",sku:"IM-025",category:"Phone Cases",price:2.9,specs:["Clear"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.50_b3694795.jpg"},{id:"img-026",name:"Accessory Photo Z",sku:"IM-026",category:"Back Glass",price:7,specs:["Glass"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.51_5e67178c.jpg"},{id:"img-027",name:"Accessory Photo AA",sku:"IM-027",category:"Batteries",price:6.9,specs:["Refurb"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.52_df23fdba.jpg"},{id:"img-028",name:"Accessory Photo AB",sku:"IM-028",category:"Chargers",price:8.5,specs:["PD"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.53_13d347f3.jpg"},{id:"img-029",name:"Accessory Photo AC",sku:"IM-029",category:"Cables",price:2.1,specs:["Braided"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.54_5c3d1851.jpg"},{id:"img-030",name:"Accessory Photo AD",sku:"IM-030",category:"Power Banks",price:12.2,specs:["Dual output"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.54_8f092381.jpg"},{id:"img-031",name:"Accessory Photo AE",sku:"IM-031",category:"Earphones",price:3.9,specs:["Wired"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.56_cbdfea17.jpg"},{id:"img-032",name:"Accessory Photo AF",sku:"IM-032",category:"Phone Cases",price:4.5,specs:["Patterned"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.57_61b6ae02.jpg"},{id:"img-033",name:"Accessory Photo AG",sku:"IM-033",category:"Screen Protectors",price:2.3,specs:["Clear"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.57_efd60a9b.jpg"},{id:"img-034",name:"Accessory Photo AH",sku:"IM-034",category:"Chargers",price:10,specs:["GaN"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.58_082b158d.jpg"},{id:"img-035",name:"Accessory Photo AI",sku:"IM-035",category:"Power Banks",price:15,specs:["High capacity"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.00_7e6451d4.jpg"},{id:"img-036",name:"Accessory Photo AJ",sku:"IM-036",category:"Cables",price:1.5,specs:["USB-C"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.01_bf466384.jpg"},{id:"img-037",name:"Accessory Photo AK",sku:"IM-037",category:"Earphones",price:7.5,specs:["TWS"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.03_2920cb02.jpg"},{id:"img-038",name:"Accessory Photo AL",sku:"IM-038",category:"Phone Cases",price:3.1,specs:["Transparent"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.03_2ae9f56f.jpg"},{id:"img-039",name:"Accessory Photo AM",sku:"IM-039",category:"Back Glass",price:6.8,specs:["OEM"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.03_725a57bf.jpg"},{id:"img-040",name:"Accessory Photo AN",sku:"IM-040",category:"Chargers",price:5.5,specs:["USB-A"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.04_faa6a5d9.jpg"}],Be=a=>new Intl.NumberFormat("en-GB",{style:"currency",currency:Oe}).format(a),Z=(...a)=>a.filter(Boolean).join(" ");function lr(){const[a,r]=w(!1);return T(()=>{var n;const t=window.matchMedia("(prefers-reduced-motion: reduce)");r(t.matches);const o=()=>r(t.matches);return(n=t.addEventListener)==null||n.call(t,"change",o),()=>{var u;return(u=t.removeEventListener)==null?void 0:u.call(t,"change",o)}},[]),a}function nt(a){const r=encodeURIComponent("#f3f4f6"),t=encodeURIComponent("#6b7280"),o=encodeURIComponent(a),n=`<?xml version='1.0' encoding='UTF-8'?><svg xmlns='http://www.w3.org/2000/svg' width='800' height='600' role='img' aria-label='${o}'><rect width='100%' height='100%' fill='${r}'/><g fill='${t}' font-family='system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, sans-serif'><text x='50%' y='50%' dominant-baseline='middle' text-anchor='middle' font-size='24'>${o}</text></g></svg>`;return`data:image/svg+xml;charset=utf-8,${encodeURIComponent(n)}`}function Et(a,r){return a?a.startsWith("data:")||a.startsWith("http")?a:`/img/${a}`:nt(r)}function ir(a){const r=Array.isArray(a.images)&&a.images.length?a.images:a.image?[a.image]:[];return r.length?r:[nt(a.name)]}function Oa(a){const r=ir(a);return Et(r[0],a.name)}function jt(a,r,t){const o=le(t);T(()=>{o.current=t},[t]),T(()=>{if(!a||!r.current)return;const n=r.current,u=["a[href]","button:not([disabled])","textarea:not([disabled])","input:not([disabled])","select:not([disabled])",'[tabindex]:not([tabindex="-1"])'].join(","),i=document.activeElement;(()=>{const h=Array.from(n.querySelectorAll(u));if(!h.length){n.hasAttribute("tabindex")||n.setAttribute("tabindex","-1"),typeof n.focus=="function"&&n.focus({preventScroll:!0});return}const d=h[0];d&&typeof d.focus=="function"&&d.focus({preventScroll:!0})})();const g=h=>{var d;if(h.key==="Escape"){h.stopPropagation(),(d=o.current)==null||d.call(o);return}if(h.key==="Tab"){const x=Array.from(n.querySelectorAll(u));if(!x.length)return;const c=x[0],m=x[x.length-1];h.shiftKey&&document.activeElement===c?(h.preventDefault(),m.focus()):!h.shiftKey&&document.activeElement===m&&(h.preventDefault(),c.focus())}};return n.addEventListener("keydown",g),()=>{if(n.removeEventListener("keydown",g),i&&typeof i.focus=="function"&&document.contains(i))try{i.focus({preventScroll:!0})}catch(h){i.focus()}}},[a])}function cr(a,r){const t=le(0),o=le(null);gt(()=>{if(typeof window=="undefined"||!a)return;const n=document.body,u=document.documentElement;if(!n||!u)return;const i=window.scrollY||window.pageYOffset||0,E=r&&Number.isFinite(r.current)?r.current:i;return t.current=E,o.current={htmlLocked:u.classList.contains("is-locked"),bodyLocked:n.classList.contains("is-locked"),lockY:n.style.getPropertyValue("--lock-y")},n.style.setProperty("--lock-y",`-${E}px`),u.classList.add("is-locked"),n.classList.add("is-locked"),()=>{const g=o.current||{};g.htmlLocked||u.classList.remove("is-locked"),g.bodyLocked||n.classList.remove("is-locked"),g.lockY?n.style.setProperty("--lock-y",g.lockY):n.style.removeProperty("--lock-y"),window.scrollTo(0,t.current||0),o.current=null}},[a,r])}function ea({open:a,title:r,onClose:t,children:o,actions:n}){const u=le(null);return jt(!!a,u,t),a?React.createElement("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4"},React.createElement("div",{className:"absolute inset-0 bg-black/40",onClick:t,"aria-hidden":"true"}),React.createElement("div",{ref:u,role:"dialog","aria-modal":"true",className:"relative w-full max-w-lg rounded-3xl border border-[var(--surface-border)] bg-white p-5 shadow-soft-xl"},React.createElement("div",{className:"flex items-start justify-between gap-3"},React.createElement("h3",{className:"text-lg font-semibold text-slate-900"},r),React.createElement("button",{type:"button",onClick:t,className:"rounded-full p-2 text-slate-500 hover:bg-slate-100","aria-label":"Close"},"\xD7")),React.createElement("div",{className:"mt-4 space-y-4"},o),n&&React.createElement("div",{className:"mt-5 flex justify-end gap-2"},n))):null}function dr({label:a,mode:r,fieldType:t,options:o,value:n,onChange:u,onEdit:i,onRemove:E}){const g=t==="checkbox",d=String(g?"single":r||"single").toLowerCase().trim().includes("multi")?"multi":"single",x=g?["Yes","No"]:Array.isArray(o)?o:[],[c,m]=w(!1),M=le(null);T(()=>{if(!c)return;const R=D=>{M.current&&!M.current.contains(D.target)&&m(!1)};return document.addEventListener("mousedown",R),document.addEventListener("touchstart",R),()=>{document.removeEventListener("mousedown",R),document.removeEventListener("touchstart",R)}},[c]);const W=!!n,_=Array.isArray(n)?n:[],B=typeof n=="string"?n:n==null?"":String(n),G=g?W?"Yes":"No":d==="multi"?_.length?`${_.length} selected`:"Select...":B||"Select...",H=()=>{u(g?!1:d==="multi"?[]:"")},$=R=>{if(g){u(R==="Yes"),m(!1);return}if(d==="multi"){const D=_.includes(R)?_.filter(v=>v!==R):[..._,R];u(D);return}u(R),m(!1)};return React.createElement("div",{ref:M,className:Z("relative rounded-2xl border border-[var(--surface-border)] bg-white/70 p-4 text-sm text-slate-600 shadow-sm backdrop-blur",c&&"z-30")},React.createElement("div",{className:"flex items-start justify-between gap-3"},React.createElement("div",{className:"flex-1"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},a),React.createElement("button",{type:"button",onClick:()=>m(R=>!R),className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/80 px-3.5 py-2.5 text-left text-sm text-slate-800 shadow-inner focus:outline-none focus-visible:outline-2 focus-visible:outline-brand","aria-expanded":c?"true":"false"},G)),React.createElement("div",{className:"mt-6 flex items-center gap-1"},React.createElement("button",{type:"button",onClick:i,className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-2.5 py-1 text-xs font-semibold text-slate-600 hover:bg-white"},"Edit"),React.createElement("button",{type:"button",onClick:H,className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-2.5 py-1 text-xs font-semibold text-slate-600 hover:bg-white",title:"Clear"},"Clear"),React.createElement("button",{type:"button",onClick:E,className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-2.5 py-1 text-xs font-semibold text-slate-600 hover:bg-white","aria-label":`Remove ${a}`},"\xD7"))),c&&React.createElement("div",{className:"absolute left-4 right-4 top-[78px] z-40 overflow-hidden rounded-2xl border border-[var(--surface-border)] bg-white shadow-soft-xl"},React.createElement("div",{className:"max-h-64 overflow-y-auto p-2"},x.map(R=>{const D=g?R==="Yes"?W:!W:d==="multi"?_.includes(R):B===R;return React.createElement("button",{key:R,type:"button",onClick:()=>$(R),className:Z("flex w-full items-center gap-3 rounded-xl px-3 py-2 text-left text-sm transition",D?"bg-brand-soft text-slate-900":"hover:bg-slate-50")},React.createElement("span",{className:Z("inline-flex h-4 w-4 items-center justify-center rounded border",D?"border-brand bg-brand text-white":"border-[var(--surface-border)] bg-white")},D?"\u2713":""),React.createElement("span",{className:"flex-1"},R))})),React.createElement("div",{className:"flex items-center justify-end border-t border-[var(--surface-border)] bg-white/80 px-3 py-2 text-xs"},React.createElement("button",{type:"button",onClick:()=>m(!1),className:"rounded-full bg-brand px-3 py-1 font-semibold text-white hover:bg-brand-muted"},"Done"))))}function mr({label:a,mode:r,options:t,value:o,onChange:n,onEdit:u,onRemove:i}){const E=Array.isArray(t)?t:[],h=String(r||"multi").toLowerCase().trim().includes("multi")?"multi":"single",d=Array.isArray(o)?o:[],x=typeof o=="string"?o:o==null?"":String(o),c=m=>{if(h==="multi"){const M=d.includes(m)?d.filter(W=>W!==m):[...d,m];n(M);return}n(x===m?"":m)};return React.createElement("div",{className:"space-y-2 rounded-2xl border border-[var(--surface-border)] bg-white/70 p-4 text-sm text-slate-600 shadow-sm backdrop-blur"},React.createElement("div",{className:"flex items-center justify-between gap-2"},React.createElement("span",{className:"text-sm font-semibold text-slate-800"},a),React.createElement("div",{className:"flex items-center gap-1 text-xs"},h==="multi"&&E.length>0&&React.createElement("button",{type:"button",onClick:()=>{n(E)},className:"rounded-full border border-[var(--surface-border)] px-2 py-0.5 font-medium text-slate-600 hover:bg-white/60"},"All"),h==="multi"&&React.createElement("button",{type:"button",onClick:()=>{n([])},className:"rounded-full border border-[var(--surface-border)] px-2 py-0.5 font-medium text-slate-600 hover:bg-white/60"},"Clear"),React.createElement("button",{type:"button",onClick:u,className:"rounded-full border border-[var(--surface-border)] px-2 py-0.5 font-medium text-slate-600 hover:bg-white/60"},"Edit"),React.createElement("button",{type:"button",onClick:i,className:"rounded-full border border-[var(--surface-border)] px-2 py-0.5 font-medium text-slate-600 hover:bg-white/60","aria-label":`Remove ${a}`},"\xD7"))),React.createElement("div",{className:"flex flex-wrap gap-1.5 text-xs"},E.map(m=>{const M=h==="multi"?d.includes(m):x===m,W=_t[m]!==void 0||/color/i.test(a);return React.createElement("button",{type:"button",key:m,onClick:()=>c(m),className:Z("inline-flex items-center gap-1 rounded-full border px-2.5 py-1 font-medium transition",M?"border-transparent bg-brand text-white shadow-sm":"border-[var(--surface-border)] bg-white/80 text-slate-700 hover:text-slate-900 hover:bg-white")},W?React.createElement(React.Fragment,null,React.createElement(st,{name:m}),m):m)})))}function ur(){const[a,r]=w([]),[t,o]=w("");T(()=>{try{const h=localStorage.getItem(De);if(h){const d=JSON.parse(h);Array.isArray(d.items)&&r(d.items),typeof d.notes=="string"&&o(d.notes)}}catch(h){}},[]),T(()=>{try{localStorage.setItem(De,JSON.stringify({items:a,notes:t}))}catch(h){}},[a,t]);const n=h=>r(d=>{const x=d.findIndex(c=>c.id===h.id&&JSON.stringify(c.variants||{})===JSON.stringify(h.variants||{}));if(x>=0){const c=[...d];return c[x]={...c[x],qty:c[x].qty+h.qty},c}return[...d,h]}),u=(h,d)=>r(x=>x.map((c,m)=>m===h?{...c,qty:Math.max(0,Number(d)||0)}:c)),i=h=>r(d=>d.filter((x,c)=>c!==h)),E=()=>r([]),g=a.reduce((h,d)=>h+d.price*d.qty,0);return{items:a,add:n,updateQty:u,removeIndex:i,clear:E,subtotal:g,notes:t,setNotes:o}}function br(a,r){const[t,o]=w(()=>Zt());return T(()=>{var E;const u=(a||[]).find(g=>g&&g.id===Pt),i=(E=u==null?void 0:u.variants)==null?void 0:E.__config;i&&typeof i=="object"&&o(Bt(i))},[a]),{catalogConfig:t,saveCatalogConfig:async u=>{const i=Bt(u);o(i);const E=ye({id:Pt,name:"__catalog_config__",sku:"__catalog_config__",category:"All",price:0,description:"Internal catalog config row",hidden:!0,images:[],specs:[],variants:{__config:i},inventory:{}}),g=await Qt(E);g&&r(h=>{const d=Array.isArray(h)?h:[],x=d.findIndex(c=>c&&c.id===Pt);if(x>=0){const c=[...d];return c[x]=g,c}return[g,...d]})}}}function pr(){const[a,r]=w([]),[t,o]=w(!0),[n,u]=w("connecting");T(()=>{(async()=>{try{u("connecting");const d=await ga();r(d);try{localStorage.setItem(Ge,JSON.stringify(d))}catch(x){}u("connected")}catch(d){console.error("Failed to load products from database:",d),u("error");try{const x=localStorage.getItem(Ge);if(x){const c=JSON.parse(x);Array.isArray(c)&&r(c.map(ye).filter(Boolean))}}catch(x){}}finally{o(!1)}})()},[]),T(()=>{if(!Pe){console.warn("\u26A0\uFE0F Cannot setup realtime: Supabase not initialized");return}console.log("\u{1F504} Setting up realtime subscription...");const h=Pe.channel("schema-db-changes").on("postgres_changes",{event:"*",schema:"public",table:"products"},d=>{console.log("\u{1F534} Realtime event received:",d.eventType,d),r(x=>{if(d.eventType==="INSERT"){console.log("\u2795 Adding product via realtime:",d.new.name);const c=ye(d.new),m=x.findIndex(M=>M.id===c.id);if(m>=0){console.log("\u{1F504} Updating existing product instead of duplicating");const M=[...x];return M[m]=c,M}return[c,...x]}if(d.eventType==="UPDATE"){console.log("\u270F\uFE0F Updating product via realtime:",d.new.name);const c=ye(d.new);return x.map(m=>m.id===d.new.id?c:m)}return d.eventType==="DELETE"?(console.log("\u{1F5D1}\uFE0F Deleting product via realtime:",d.old.id),x.filter(c=>c.id!==d.old.id)):x})}).subscribe(d=>{console.log("\u{1F534} Realtime status:",d),d==="SUBSCRIBED"?(console.log("\u2705 Realtime subscription active!"),u("connected"),ga().then(x=>{console.log("\u{1F504} Reloaded products after reconnection");const c=x.map(ye).filter(Boolean);r(c);try{localStorage.setItem(Ge,JSON.stringify(c))}catch(m){}}).catch(x=>{console.error("\u274C Failed to reload products after reconnection:",x)})):d==="CHANNEL_ERROR"||d==="CLOSED"?(console.error("\u274C Realtime subscription failed!"),u("error")):(console.log("\u{1F504} Realtime connecting..."),u("connecting"))});return()=>{console.log("\u{1F50C} Cleaning up realtime subscription"),h.unsubscribe()}},[]);const i=h=>{if(typeof h=="function")r(d=>{const x=h(d),c=(Array.isArray(x)?x:[]).map(ye).filter(Boolean);try{localStorage.setItem(Ge,JSON.stringify(c))}catch(m){}return c});else{const d=(Array.isArray(h)?h:[]).map(ye).filter(Boolean);r(d);try{localStorage.setItem(Ge,JSON.stringify(d))}catch(x){}}};return{ownerProducts:a,setOwnerProducts:i,addProduct:async h=>{const d=await Ua(h);if(d)return i(c=>[d,...c]),{product:d,persisted:!0};const x=ye(h);return i(c=>[x,...c]),{product:x,persisted:!1}},deleteProduct:async h=>{const d=await Ga(h);return d&&i(x=>x.filter(c=>c.id!==h)),d},loading:t,connectionStatus:n}}const Pa=a=>{var c;if(!a)return null;const{total_cents:r,totalCents:t,currency:o,status:n,order_items:u,orderItems:i,metadata:E,...g}=a,h=Number((c=r!=null?r:t)!=null?c:0),x=(Array.isArray(u)?u:Array.isArray(i)?i:[]).map(m=>{var W,_,B,G,H,$,R,D;if(!m)return null;const M=Number((H=(W=m.subtotal_cents)!=null?W:m.subtotalCents)!=null?H:(Number((_=m.quantity)!=null?_:0)||0)*(Number((G=(B=m.unit_price_cents)!=null?B:m.unitPriceCents)!=null?G:0)||0));return{...m,quantity:Number(($=m.quantity)!=null?$:0),unit_price_cents:Number((D=(R=m.unit_price_cents)!=null?R:m.unitPriceCents)!=null?D:0),subtotal_cents:M}}).filter(Boolean);return{...g,status:(n||"open").toLowerCase(),total_cents:h,currency:o||St,metadata:E||{},order_items:x}},Ba=a=>{if(!a)return 0;const r=a.created_at||a.createdAt||a.inserted_at||a.insertedAt,t=r?new Date(r).getTime():0;return Number.isFinite(t)?t:0},_a=a=>[...Array.isArray(a)?a:[]].sort((t,o)=>Ba(o)-Ba(t));function fr(){const[a,r]=w([]),[t,o]=w(!0),[n,u]=w(null),[i,E]=w(null),g=React.useCallback(async()=>{try{o(!0),u(null);const d=await dt("listOrders"),c=(Array.isArray(d==null?void 0:d.data)?d.data:[]).map(Pa).filter(Boolean);r(_a(c)),E((d==null?void 0:d.meta)||null)}catch(d){console.error("Failed to load orders",d),u(d),r([]),E(null)}finally{o(!1)}},[]);T(()=>{g()},[g]);const h=React.useCallback(async(d,x)=>{if(!d||!x)return null;try{const c=await dt("updateOrderStatus",{id:d,status:x}),m=Pa(c==null?void 0:c.data);return m&&r(M=>{const W=M.map(_=>_.id===m.id?m:_);return _a(W)}),m}catch(c){throw console.error("Failed to update order status",c),c!=null&&c.message&&/404/.test(c.message)?new Error("Order no longer exists. Refresh the list and try again."):new Error((c==null?void 0:c.message)||"Unable to update order status. Please try again.")}},[]);return{orders:a,loadingOrders:t,ordersError:n,ordersMeta:i,refreshOrders:g,updateOrderStatus:h}}function yr({className:a}){return React.createElement("svg",{className:a,fill:"currentColor",viewBox:"0 0 24 24"},React.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}))}function ta({className:a}){return React.createElement("svg",{className:a,fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor"},React.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"}))}function gr({className:a}){return React.createElement("svg",{className:a,fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor"},React.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 3h1.386c.51 0 .955.343 1.087.835l.383 1.437M7.5 14.25a3 3 0 0 0-3 3h15.75m-12.75-3h11.218c1.121-2.3 2.1-4.684 2.924-7.138a60.114 60.114 0 0 0-16.536-1.84M7.5 14.25 5.106 5.272M6 20.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Zm12.75 0a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Z"}))}function Ma({className:a}){return React.createElement("svg",{className:a,fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor"},React.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"}))}function xr({className:a}){return React.createElement("svg",{className:a,fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor"},React.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3"}))}function hr({className:a}){return React.createElement("svg",{className:a,fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor"},React.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.164a1.5 1.5 0 0 0-1.5 1.5v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))}function vr({className:a}){return React.createElement("svg",{className:a,fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor"},React.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 13.5v2.25m2.598-9.05a6.75 6.75 0 1 1-5.196 0m7.346 9.591 1.263 1.263m-9.856-1.263L6.892 17.05m.944-4.117L5.4 8.5m13.2 0-2.436 4.433"}))}function wr({className:a}){return React.createElement("svg",{className:a,fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor"},React.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v6m3-3H9m12 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}function Er({className:a}){return React.createElement("svg",{className:a,fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor"},React.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5.25H7.5a2.25 2.25 0 0 0-2.25 2.25v9A2.25 2.25 0 0 0 7.5 18.75h9a2.25 2.25 0 0 0 2.25-2.25v-9A2.25 2.25 0 0 0 16.5 5.25H15m-6 0A1.5 1.5 0 0 1 10.5 3.75h3A1.5 1.5 0 0 1 15 5.25m-6 0v.75A1.5 1.5 0 0 0 10.5 7.5h3A1.5 1.5 0 0 0 15 6V5.25"}))}function Nr({className:a}){return React.createElement("svg",{className:a,fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor"},React.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 7.5h13.5v9h-13.5V7.5Zm13.5 0H18a2.25 2.25 0 0 1 1.8.9l1.95 2.6a2.25 2.25 0 0 1 .45 1.35v4.65h-2.25m-1.5 0a1.5 1.5 0 1 0-3 0m3 0H15.75m-9 0a1.5 1.5 0 1 0-3 0m3 0H3.75"}))}function ja({className:a}){return React.createElement("svg",{className:a,fill:"currentColor",viewBox:"0 0 24 24"},React.createElement("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 0 1-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 0 1-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 0 1 2.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0 0 12.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 0 0 5.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0 0 20.885 3.488"}))}function aa({status:a}){const r=(a||"").toLowerCase(),t=r==="confirmed"?"border-emerald-200 bg-emerald-50 text-emerald-700":r==="shipped"?"border-sky-200 bg-sky-50 text-sky-700":r==="cancelled"?"border-rose-200 bg-rose-50 text-rose-700":"border-amber-200 bg-amber-50 text-amber-800";return React.createElement("span",{className:Z("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-medium capitalize",t)},Mt[r]||r||"Open")}function It({title:a,value:r,subtext:t,trend:o}){return React.createElement("div",{className:"rounded-2xl border border-slate-200 bg-white/90 p-4 shadow-sm ring-1 ring-black/5 sm:p-5"},React.createElement("p",{className:"text-sm font-medium text-slate-500"},a),React.createElement("p",{className:"mt-2 text-2xl font-semibold tracking-tight text-slate-900"},r),t&&React.createElement("p",{className:"mt-1 text-xs text-slate-500"},t),o&&React.createElement("div",{className:"mt-3 inline-flex items-center gap-1 rounded-full bg-emerald-50 px-2 py-1 text-xs font-medium text-emerald-700"},o))}function Rr({allProducts:a,ownerProducts:r,orders:t,loadingOrders:o,ordersMeta:n,ordersError:u,onNavigate:i,refreshOrders:E}){const g=a.filter(R=>!R.hidden).length,h=r.filter(R=>R.sourceId&&!R.hidden).length,d=r.filter(R=>!R.sourceId&&!R.hidden).length,x=r.filter(R=>R.hidden).length,c=t.reduce((R,D)=>{const v=((D==null?void 0:D.status)||"open").toLowerCase();return R[v]=(R[v]||0)+1,R},{}),m=[...Ca,"cancelled"],M=c.open||0,W=c.confirmed||0,_=c.shipped||0,B=t.filter(R=>["confirmed","shipped"].includes(((R==null?void 0:R.status)||"").toLowerCase())).reduce((R,D)=>R+(Number(D==null?void 0:D.total_cents)||0),0),G=new Intl.NumberFormat("en-GB",{style:"currency",currency:Oe}).format(B/100),H=t.slice(0,5),$=R=>{i==null||i(R)};return React.createElement("div",{className:"flex flex-col gap-10"},React.createElement("header",{className:"flex flex-col gap-4 sm:flex-row sm:items-end sm:justify-between"},React.createElement("div",null,React.createElement("h1",{className:"text-2xl font-semibold tracking-tight text-slate-900"},"Owner dashboard"),React.createElement("p",{className:"mt-1 text-sm text-slate-600"},"Monitor catalogue health and stay on top of incoming orders."))),React.createElement("section",{className:"grid gap-4 sm:grid-cols-2 xl:grid-cols-4"},React.createElement(It,{title:"Active SKUs",value:g,subtext:h?`${h} overrides`:void 0}),React.createElement(It,{title:"Owner additions",value:d,subtext:x?`${x} hidden`:"Live to customers"}),React.createElement(It,{title:"Open orders",value:o?"\u2014":M,subtext:W?`${W} confirmed`:"Awaiting confirmation"}),React.createElement(It,{title:"Fulfilled value",value:G,subtext:_?`${_} shipped`:"No shipments yet"})),React.createElement("section",{className:"grid gap-6 lg:grid-cols-[minmax(0,1fr),minmax(0,1fr)]"},React.createElement("div",{className:"rounded-2xl border border-slate-200 bg-white/80 p-6 shadow-sm ring-1 ring-black/5"},React.createElement("div",{className:"flex items-center justify-between gap-3"},React.createElement("div",null,React.createElement("h2",{className:"text-base font-semibold text-slate-900"},"Order pipeline"),React.createElement("p",{className:"mt-1 text-sm text-slate-500"},"Track each stage to keep fulfilment moving.")),React.createElement("button",{type:"button",onClick:E,className:"inline-flex items-center gap-2 rounded-full border border-slate-300 bg-white px-3 py-1.5 text-xs font-medium text-slate-700 hover:bg-slate-50 focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",disabled:o},o?"Refreshing\u2026":"Refresh")),u?/schema cache|relation "orders"/i.test(u.message||"")?React.createElement("div",{className:"mt-4 rounded-xl border border-amber-200 bg-amber-50 p-4 text-sm text-amber-900"},React.createElement("p",{className:"font-medium"},"Orders table not detected"),React.createElement("p",{className:"mt-1"},"Set up the orders tables & policies in Supabase, then refresh to start tracking customer purchase history.")):React.createElement("div",{className:"mt-4 rounded-xl border border-rose-200 bg-rose-50 p-4 text-sm text-rose-900"},React.createElement("p",{className:"font-medium"},"Orders could not be loaded"),React.createElement("p",{className:"mt-1"},u.message||"Check your connection or Supabase policies and try again.")):n!=null&&n.missingOrdersTable?React.createElement("div",{className:"mt-4 rounded-xl border border-amber-200 bg-amber-50 p-4 text-sm text-amber-900"},React.createElement("p",{className:"font-medium"},"Orders table not detected"),React.createElement("p",{className:"mt-1"},"Set up the orders tables & policies in Supabase, then refresh to start tracking customer purchase history.")):React.createElement("dl",{className:"mt-6 grid grid-cols-1 gap-4 sm:grid-cols-4"},m.map(R=>React.createElement("div",{key:R,className:Z("rounded-xl border px-4 py-3 text-center flex flex-col items-center justify-center gap-1",R==="open"?"border-amber-200 bg-amber-50 text-amber-800":R==="confirmed"?"border-emerald-200 bg-emerald-50 text-emerald-700":R==="shipped"?"border-sky-200 bg-sky-50 text-sky-700":"border-rose-200 bg-rose-50 text-rose-700")},React.createElement("dt",{className:"text-[11px] font-medium uppercase tracking-wide"},Mt[R]||R),React.createElement("dd",{className:"text-2xl font-semibold leading-none"},o?"\u2014":c[R]||0))))),React.createElement("div",{className:"rounded-2xl border border-slate-200 bg-white/80 p-6 shadow-sm ring-1 ring-black/5"},React.createElement("div",{className:"flex items-center justify-between gap-3"},React.createElement("div",null,React.createElement("h2",{className:"text-base font-semibold text-slate-900"},"Recent orders"),React.createElement("p",{className:"mt-1 text-sm text-slate-500"},H.length?"Latest activity from verified customers.":"No orders yet \u2014 your list will appear here.")),React.createElement("button",{type:"button",onClick:()=>$("orders"),className:"inline-flex items-center gap-2 rounded-full border border-slate-300 bg-white px-3 py-1.5 text-xs font-medium text-slate-700 hover:bg-slate-50 focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"Open orders")),H.length>0&&React.createElement("ul",{className:"mt-5 space-y-3"},H.map(R=>React.createElement("li",{key:R.id,className:"rounded-xl border border-slate-200 bg-white px-4 py-3 shadow-sm"},React.createElement("div",{className:"flex items-start justify-between gap-3"},React.createElement("div",null,React.createElement("p",{className:"text-sm font-medium text-slate-900"},R.customer_name||R.customer_email||"Customer"),React.createElement("p",{className:"text-xs text-slate-500"},R.customer_email||"Email pending")),React.createElement(aa,{status:R.status})),React.createElement("div",{className:"mt-3 flex items-center justify-between text-xs text-slate-500"},React.createElement("span",null,new Intl.DateTimeFormat("en-GB",{dateStyle:"medium",timeStyle:"short"}).format(new Date(R.created_at||R.createdAt||Date.now()))),React.createElement("span",{className:"font-medium text-slate-700"},new Intl.NumberFormat("en-GB",{style:"currency",currency:Oe}).format((Number(R.total_cents)||0)/100)))))))))}function kr({orders:a,loading:r,error:t,meta:o,onRefresh:n,onStatusChange:u,onNotify:i}){var R,D;const[E,g]=w("open"),[h,d]=w(null),[x,c]=w(!1),m=J(()=>a.reduce((v,z)=>{const O=((z==null?void 0:z.status)||"open").toLowerCase();return v[O]=(v[O]||0)+1,v.all=(v.all||0)+1,v},{all:0}),[a]),M=J(()=>Array.from(new Set([...Ca,"cancelled","all"])),[]),W=J(()=>E==="all"?a:a.filter(v=>((v==null?void 0:v.status)||"open").toLowerCase()===E),[a,E]);T(()=>{var v;if(!W.length){d(null);return}(!h||!W.some(z=>z.id===h))&&d(((v=W[0])==null?void 0:v.id)||null)},[W,h]);const _=W.find(v=>v.id===h)||null,B=J(()=>new Intl.NumberFormat("en-GB",{style:"currency",currency:Oe}),[]),G=v=>B.format((Number(v)||0)/100),H=v=>{try{return new Intl.DateTimeFormat("en-GB",{dateStyle:"medium",timeStyle:"short"}).format(new Date(v))}catch(z){return"\u2014"}},$=async(v,z)=>{const O=String(z||"").toLowerCase();if(!(!v||!O)){if(!nr.includes(O)){i==null||i("error",`Unsupported status transition: ${z}`);return}try{if(c(!0),await(u==null?void 0:u(v,O))){const A=Mt[O]||O;i==null||i("success",`Order status updated to ${A}.`)}}catch(b){console.error("Failed to update order status",b),i==null||i("error",(b==null?void 0:b.message)||"Unable to update order status right now.")}finally{c(!1)}}};if(o!=null&&o.missingOrdersTable)return React.createElement("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 p-6 text-sm text-amber-900 shadow-sm"},React.createElement("h2",{className:"text-base font-semibold text-amber-900"},"Orders table not detected"),React.createElement("p",{className:"mt-2"},"Create the orders and order_items tables in Supabase, apply RLS policies, then refresh this view to start tracking customer history."),React.createElement("div",{className:"mt-4 flex flex-wrap gap-2 text-xs"},React.createElement("span",{className:"rounded-full border border-amber-300 bg-white px-3 py-1 text-amber-700"},"orders"),React.createElement("span",{className:"rounded-full border border-amber-300 bg-white px-3 py-1 text-amber-700"},"order_items")),React.createElement("button",{type:"button",onClick:n,className:"mt-4 inline-flex items-center gap-2 rounded-full border border-amber-300 bg-white px-4 py-2 text-xs font-medium text-amber-800 hover:bg-amber-100 focus:outline-none focus-visible:outline-2 focus-visible:outline-amber-500"},"Refresh"));if(t){const v=(t==null?void 0:t.message)||"";return/schema cache|relation "orders"/i.test(v)?React.createElement("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 p-6 text-sm text-amber-900 shadow-sm"},React.createElement("h2",{className:"text-base font-semibold text-amber-900"},"Orders table not detected"),React.createElement("p",{className:"mt-2"},"Create the orders and order_items tables in Supabase, apply RLS policies, then refresh this view to start tracking customer history."),React.createElement("div",{className:"mt-4 flex flex-wrap gap-2 text-xs"},React.createElement("span",{className:"rounded-full border border-amber-300 bg-white px-3 py-1 text-amber-700"},"orders"),React.createElement("span",{className:"rounded-full border border-amber-300 bg-white px-3 py-1 text-amber-700"},"order_items")),React.createElement("button",{type:"button",onClick:n,className:"mt-4 inline-flex items-center gap-2 rounded-full border border-amber-300 bg-white px-4 py-2 text-xs font-medium text-amber-800 hover:bg-amber-100 focus:outline-none focus-visible:outline-2 focus-visible:outline-amber-500"},"Refresh")):React.createElement("div",{className:"rounded-2xl border border-rose-200 bg-rose-50 p-6 text-sm text-rose-900 shadow-sm"},React.createElement("h2",{className:"text-base font-semibold text-rose-900"},"Unable to load orders"),React.createElement("p",{className:"mt-2"},t.message||"Check your connection or Supabase permissions and try again."),React.createElement("button",{type:"button",onClick:n,className:"mt-4 inline-flex items-center gap-2 rounded-full border border-rose-300 bg-white px-4 py-2 text-xs font-medium text-rose-700 hover:bg-rose-100 focus:outline-none focus-visible:outline-2 focus-visible:outline-rose-500"},"Retry"))}return React.createElement("div",{className:"flex flex-col gap-6"},React.createElement("header",{className:"flex flex-col gap-3 sm:flex-row sm:items-end sm:justify-between"},React.createElement("div",null,React.createElement("h2",{className:"text-xl font-semibold text-slate-900"},"Orders pipeline"),React.createElement("p",{className:"text-sm text-slate-600"},"Move orders from open to shipped, while keeping a full audit trail.")),React.createElement("div",{className:"flex flex-wrap gap-2 text-xs text-slate-500"},React.createElement("span",{className:"rounded-full border border-amber-200 bg-amber-50 px-3 py-1 text-amber-700"},`Open: ${m.open||0}`),React.createElement("span",{className:"rounded-full border border-emerald-200 bg-emerald-50 px-3 py-1 text-emerald-700"},`Confirmed: ${m.confirmed||0}`),React.createElement("span",{className:"rounded-full border border-sky-200 bg-sky-50 px-3 py-1 text-sky-700"},`Shipped: ${m.shipped||0}`),React.createElement("button",{type:"button",onClick:n,className:"inline-flex items-center gap-2 rounded-full border border-slate-300 bg-white px-3 py-1 text-slate-700 hover:bg-slate-50 focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},r?"Refreshing\u2026":"Refresh"))),React.createElement("div",{className:"flex flex-wrap gap-2"},M.map(v=>React.createElement("button",{key:v,type:"button",onClick:()=>g(v),className:Z("rounded-full border px-3 py-1.5 text-xs font-medium transition focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",E===v?"border-brand bg-[var(--brand-soft-strong)] text-brand shadow-sm":"border-slate-300 bg-white text-slate-600 hover:bg-slate-50")},v==="all"?"All":Mt[v]||v))),r&&!a.length?React.createElement("div",{className:"flex items-center justify-center rounded-2xl border border-slate-200 bg-white/80 p-10 text-slate-500"},"Loading orders\u2026"):W.length?React.createElement("div",{className:"grid gap-6 lg:grid-cols-[minmax(0,1fr),minmax(0,360px)]"},React.createElement("div",{className:"space-y-3"},W.map(v=>React.createElement("button",{key:v.id,type:"button",onClick:()=>d(v.id),className:Z("w-full rounded-2xl border px-4 py-3 text-left shadow-sm transition focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",v.id===h?"border-brand bg-[var(--brand-soft-strong)]/70 text-slate-900 shadow-md":"border-slate-200 bg-white hover:border-slate-300")},React.createElement("div",{className:"flex items-start justify-between gap-3"},React.createElement("div",null,React.createElement("p",{className:"text-sm font-semibold text-slate-900"},v.customer_name||"Customer"),React.createElement("p",{className:"text-xs text-slate-500"},v.customer_email||"Email pending")),React.createElement(aa,{status:v.status})),React.createElement("div",{className:"mt-3 flex items-center justify-between text-xs text-slate-500"},React.createElement("span",null,H(v.created_at||v.createdAt)),React.createElement("span",{className:"font-medium text-slate-700"},G(v.total_cents)))))),React.createElement("aside",{className:"rounded-2xl border border-slate-200 bg-white/90 p-5 shadow-sm"},_?React.createElement("div",{className:"flex flex-col gap-4"},React.createElement("div",{className:"flex items-start justify-between gap-3"},React.createElement("div",null,React.createElement("h3",{className:"text-base font-semibold text-slate-900"},_.customer_name||"Customer"),React.createElement("p",{className:"text-xs text-slate-500"},_.customer_email||"Email pending")),React.createElement(aa,{status:_.status})),React.createElement("dl",{className:"grid grid-cols-2 gap-3 text-xs text-slate-500"},React.createElement("div",null,React.createElement("dt",{className:"font-medium uppercase tracking-wide text-slate-600"},"Placed"),React.createElement("dd",{className:"mt-1 text-slate-700"},H(_.created_at||_.createdAt))),React.createElement("div",null,React.createElement("dt",{className:"font-medium uppercase tracking-wide text-slate-600"},"Total"),React.createElement("dd",{className:"mt-1 text-slate-700 font-semibold"},G(_.total_cents))),_.updated_at&&React.createElement("div",{className:"col-span-2"},React.createElement("dt",{className:"font-medium uppercase tracking-wide text-slate-600"},"Updated"),React.createElement("dd",{className:"mt-1 text-slate-700"},H(_.updated_at)))),_.order_items&&_.order_items.length>0&&React.createElement("div",null,React.createElement("h4",{className:"text-sm font-semibold text-slate-800"},"Items"),React.createElement("ul",{className:"mt-3 space-y-3"},_.order_items.map(v=>React.createElement("li",{key:v.id||`${v.product_id}-${v.sku}`},React.createElement("div",{className:"flex items-start justify-between gap-3 text-sm text-slate-700"},React.createElement("div",null,React.createElement("p",{className:"font-medium text-slate-900"},v.name||"Item"),v.sku&&React.createElement("p",{className:"text-xs text-slate-500"},"SKU: ",v.sku)),React.createElement("span",{className:"text-xs text-slate-500"},`\xD7${v.quantity||0}`)),v.variants&&Object.keys(v.variants).length>0&&React.createElement("div",{className:"mt-1 flex flex-wrap gap-1 text-xs text-slate-600"},Object.entries(v.variants).map(([z,O])=>{const b=Array.isArray(O)?O.join(", "):O,A=/color/i.test(z);return React.createElement("span",{key:z,className:Z("inline-flex items-center gap-1 rounded-full border px-2 py-0.5",A?"border-slate-300 bg-slate-50":"border-slate-200 bg-white")},A?React.createElement(st,{name:b}):null,`${z}: ${b}`)})),React.createElement("div",{className:"mt-1 flex items-center justify-between text-xs text-slate-500"},React.createElement("span",null,G(v.unit_price_cents)),React.createElement("span",{className:"font-medium text-slate-700"},G(v.subtotal_cents))))))),(_.note||((R=_.metadata)==null?void 0:R.notes))&&React.createElement("div",{className:"rounded-xl border border-slate-200 bg-slate-50 px-3 py-2 text-xs text-slate-600"},_.note||((D=_.metadata)==null?void 0:D.notes)),React.createElement("div",{className:"flex flex-wrap gap-2"},(()=>{const v=(_.status||"open").toLowerCase(),z=[];return v==="open"&&(z.push({label:"Mark as confirmed",next:"confirmed"}),z.push({label:"Cancel order",next:"cancelled",variant:"danger"})),v==="confirmed"&&(z.push({label:"Mark as shipped",next:"shipped"}),z.push({label:"Cancel order",next:"cancelled",variant:"danger"})),z.map(O=>React.createElement("button",{key:O.next,type:"button",onClick:()=>$(_.id,O.next),disabled:x,className:Z("inline-flex items-center gap-2 rounded-full border px-4 py-2 text-xs font-medium shadow-sm focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",O.variant==="danger"?"border-rose-300 bg-rose-50 text-rose-700 hover:bg-rose-100":O.next==="shipped"?"border-sky-300 bg-sky-50 text-sky-700 hover:bg-sky-100":"border-emerald-300 bg-emerald-50 text-emerald-700 hover:bg-emerald-100",x?"opacity-60":"")},x?"Updating\u2026":O.label))})())):React.createElement("p",{className:"text-sm text-slate-500"},W.length?"Select an order to see its breakdown.":"No orders in this stage yet."))):React.createElement("div",{className:"rounded-2xl border border-slate-200 bg-white/80 p-8 text-sm text-slate-500"},"No orders in this stage yet."))}function Sr({views:a,section:r,onSectionChange:t}){const o=a.find(n=>n.id===r)||a[0];return React.createElement("main",{id:"main",className:"mx-auto w-full max-w-7xl px-4 pb-16 pt-6 sm:px-6 lg:px-8"},React.createElement("div",{className:"grid gap-6 lg:grid-cols-[minmax(200px,240px),minmax(0,1fr)]"},React.createElement("nav",{className:"flex snap-x snap-mandatory gap-3 overflow-x-auto pb-1 lg:flex-col lg:overflow-visible lg:pb-0"},a.map(n=>React.createElement("button",{key:n.id,type:"button",onClick:()=>t(n.id),className:Z("snap-start rounded-2xl border px-4 py-3 text-left shadow-sm transition focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",n.id===o.id?"border-brand bg-brand-soft text-brand":"border-slate-200 bg-white text-slate-600 hover:border-slate-300 hover:bg-slate-50")},n.icon?React.createElement(n.icon,{className:"mb-2 h-5 w-5 text-current"}):null,React.createElement("span",{className:"block text-sm font-semibold"},n.label),n.description&&React.createElement("span",{className:"mt-1 block text-xs text-slate-500"},n.description)))),React.createElement("section",{className:"min-h-[480px]"},(o==null?void 0:o.element)||React.createElement("p",{className:"text-sm text-slate-500"},"Select a section to begin."))))}function Ar(){return React.createElement("a",{href:"#main",className:"sr-only focus:not-sr-only focus:fixed focus:top-2 focus:left-2 rounded-full border border-[var(--surface-border)] bg-white/90 px-3 py-2 text-sm font-semibold text-brand shadow-sm backdrop-blur"},"Skip to content")}function Cr({onOpenCart:a,search:r,setSearch:t,ownerMode:o,setOwnerMode:n,cartQty:u,connectionStatus:i,allowOwnerToggle:E}){const[g,h]=w(!1),d=le(null);T(()=>{const c=()=>h(window.scrollY>4);return c(),window.addEventListener("scroll",c,{passive:!0}),()=>window.removeEventListener("scroll",c)},[]),T(()=>{const c=()=>{var M;const m=((M=d.current)==null?void 0:M.offsetHeight)||64;document.documentElement.style.setProperty("--header-offset",m+"px")};return c(),window.addEventListener("resize",c,{passive:!0}),()=>window.removeEventListener("resize",c)},[o,r]);const x=i==="connected"?{wrapper:"border border-emerald-200 bg-emerald-50/80 text-emerald-600",dot:"bg-emerald-500",label:"Online"}:i==="error"?{wrapper:"border border-rose-200 bg-rose-50/80 text-rose-600",dot:"bg-rose-500",label:"Offline"}:{wrapper:"border border-amber-200 bg-amber-50/80 text-amber-600",dot:"bg-amber-400 animate-pulse",label:"Connecting"};return React.createElement("header",{ref:d,className:Z("sticky top-0 z-40 w-full border-b border-[var(--surface-border)] bg-[rgba(246,247,251,0.85)] backdrop-blur-xl transition-shadow duration-300",g?"shadow-sm":"")},React.createElement("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8"},React.createElement("div",{className:"flex h-16 items-center justify-between gap-3"},React.createElement("div",{className:"flex items-center gap-3 min-w-0"},React.createElement(yr,{className:"h-7 w-7 text-brand flex-shrink-0"}),React.createElement("div",{className:"flex items-center gap-3 min-w-0"},React.createElement("span",{className:"font-semibold text-slate-900 text-sm sm:text-base tracking-tight truncate"},Ht),React.createElement("div",{className:`hidden md:flex items-center gap-1 rounded-full px-2.5 py-1 text-[11px] font-medium ${x.wrapper}`,title:`Database ${i}`},React.createElement("span",{className:`inline-block h-2 w-2 rounded-full ${x.dot}`}),React.createElement("span",null,x.label)))),React.createElement("nav",{className:"flex items-center gap-1.5 sm:gap-2"},!o&&React.createElement("label",{className:"relative hidden sm:block"},React.createElement("span",{className:"sr-only"},"Search"),React.createElement("input",{value:r,onChange:c=>t(c.target.value),placeholder:"Search products\u2026",type:"search",className:"w-48 md:w-64 rounded-full border border-[var(--surface-border)] bg-white/60 px-3 py-2 text-sm font-medium text-slate-600 shadow-inner backdrop-blur focus:outline-none focus:ring-2 focus:ring-brand focus:border-transparent placeholder:text-slate-400"}),React.createElement(ta,{className:"pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"})),E&&React.createElement("button",{onClick:()=>n(!o),className:Z("rounded-full border px-3 py-2 text-xs sm:text-sm font-medium transition-colors focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",o?"border-transparent bg-brand text-white shadow-sm":"border-[var(--surface-border)] bg-white/60 text-slate-700 hover:bg-white/80")},o?"Back":"Owner"),React.createElement("button",{onClick:a,className:"relative inline-flex items-center gap-1 rounded-full border border-[var(--surface-border)] bg-white/60 px-2.5 sm:px-3.5 py-2 text-xs sm:text-sm font-medium text-slate-700 transition-colors hover:bg-white/80 focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},React.createElement(gr,{className:"h-4 w-4 text-brand"}),React.createElement("span",{className:"hidden sm:inline"},"Cart"),u>0&&React.createElement("span",{"aria-live":"polite",className:"absolute -top-1.5 -right-1.5 inline-flex h-5 min-w-[1.25rem] items-center justify-center rounded-full border border-[rgba(37,99,235,0.28)] bg-[rgba(37,99,235,0.12)] px-1 text-[10px] font-semibold text-brand"},String(u))))),!o&&React.createElement("div",{className:"sm:hidden pb-0"},React.createElement("label",{className:"relative block"},React.createElement("span",{className:"sr-only"},"Search"),React.createElement("input",{value:r,onChange:c=>t(c.target.value),placeholder:"Search products\u2026",type:"search",className:"w-full rounded-full border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm font-medium text-slate-700 shadow-inner backdrop-blur focus:outline-none focus:ring-2 focus:ring-brand focus:border-transparent placeholder:text-slate-400"}),React.createElement(ta,{className:"pointer-events-none absolute right-4 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"})))))}function Or(){const a=[{title:"1. Browse products",detail:"Search or tap a category to find what you need."},{title:"2. Open an item",detail:"Choose the variants and quantities, then add to cart."},{title:"3. Review the cart",detail:"Adjust quantities or notes before sending."},{title:"4. Send via WhatsApp",detail:"Use the cart button to submit the full list for confirmation."}];return React.createElement("section",{"aria-labelledby":"hero-title",className:"border-b border-[var(--surface-border)] bg-hero-gradient"},React.createElement("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-16"},React.createElement("div",{className:"grid gap-12 lg:grid-cols-[minmax(0,1fr)_420px] items-start"},React.createElement("div",{className:"space-y-6"},React.createElement("span",{className:"inline-flex items-center gap-2 rounded-full border border-[var(--surface-border)] bg-white/60 px-3 py-1 text-[11px] font-medium uppercase tracking-[0.14em] text-slate-600"},"Odil Accessories"),React.createElement("h1",{id:"hero-title",className:"text-[clamp(30px,6vw,48px)] font-semibold leading-tight tracking-tight text-slate-900"},"Wholesale catalogue for partner shops"),React.createElement("p",{className:"max-w-2xl text-base sm:text-lg text-slate-600"},xt),React.createElement("div",{className:"flex flex-wrap gap-3"},React.createElement("a",{href:"#catalogue",className:"inline-flex items-center gap-2 rounded-full bg-brand px-5 py-2.5 text-sm font-semibold text-white shadow-sm transition hover:bg-brand-muted focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"Browse catalogue",React.createElement(xr,{className:"h-4 w-4"})),React.createElement("a",{href:`https://wa.me/${Re}`,target:"_blank",rel:"noreferrer noopener",className:"inline-flex items-center gap-2 rounded-full border border-[rgba(37,99,235,0.35)] bg-white/70 px-5 py-2.5 text-sm font-semibold text-slate-800 shadow-sm backdrop-blur transition hover:bg-white/90 focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},React.createElement(ja,{className:"h-4 w-4 text-emerald-500"}),"Chat on WhatsApp")),React.createElement("p",{className:"text-sm text-slate-500"},"Follow the steps on the right when you place an order.")),React.createElement("div",{className:"glass-card rounded-3xl p-8 soft-shadow"},React.createElement("div",{className:"space-y-5 text-sm text-slate-600"},React.createElement("h2",{className:"text-base font-semibold text-slate-900"},"Order steps"),React.createElement("ol",{className:"space-y-3 text-sm"},a.map(r=>React.createElement("li",{key:r.title,className:"rounded-2xl border border-[var(--surface-border)] bg-white/70 px-4 py-3 backdrop-blur"},React.createElement("p",{className:"text-sm font-semibold text-slate-900"},r.title),React.createElement("p",{className:"text-xs text-slate-500 mt-1"},r.detail))))),React.createElement("div",{className:"mt-6 flex items-center justify-between rounded-2xl border border-[var(--surface-border)] bg-white/80 px-4 py-3 text-xs uppercase tracking-[0.18em] text-slate-500"},React.createElement("span",null,"Owner metrics snapshot"),React.createElement("span",{className:"font-semibold text-slate-800"},"Realtime"))))))}function Pr({active:a,setActive:r}){const t=le(null),[o,n]=w({left:!1,right:!1});T(()=>{const i=()=>{const g=t.current;if(!g)return;const{scrollLeft:h,scrollWidth:d,clientWidth:x}=g,c=h>0,m=h+x<d-1;n(M=>M.left===c&&M.right===m?M:{left:c,right:m})};i();const E=t.current;if(E)return E.addEventListener("scroll",i,{passive:!0}),window.addEventListener("resize",i),()=>{E.removeEventListener("scroll",i),window.removeEventListener("resize",i)}},[]);const u=Z("relative -mx-4 overflow-x-auto px-4 chip-scroll-fade",o.left&&"show-left",o.right&&"show-right");return React.createElement(React.Fragment,null,React.createElement("div",{className:"sticky top-[var(--header-offset,64px)] z-30 border-b border-[var(--surface-border)] bg-[rgba(246,247,251,0.85)] backdrop-blur-lg"},React.createElement("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8","aria-label":"Categories"},React.createElement("div",{ref:t,className:u},React.createElement("div",{className:"flex gap-2 py-2 text-[11px]"},At.map(i=>React.createElement("button",{key:i,onClick:()=>r(i),"aria-pressed":a===i,className:Z("inline-flex items-center whitespace-nowrap rounded-full border px-3.5 py-1.5 text-[11px] font-semibold uppercase tracking-[0.18em] transition-colors focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",a===i?"border-transparent bg-brand text-white shadow-sm":"border-[var(--surface-border)] bg-white/70 text-slate-600 hover:text-slate-900 hover:bg-white/90")},i)))))))}function Br({products:a,onOpen:r}){return React.createElement("section",{id:"catalogue","aria-labelledby":"catalogue-title",className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-6"},React.createElement("h2",{id:"catalogue-title",className:"sr-only"},"Catalogue"),React.createElement("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"},a.map(t=>React.createElement(_r,{key:t.id,product:t,onOpen:r}))))}function _r({product:a,onOpen:r}){const[t,o]=w(Oa(a));return T(()=>{o(Oa(a))},[a.image,a.images,a.name]),React.createElement("article",{className:"group flex flex-col overflow-hidden rounded-3xl border border-[var(--surface-border)] bg-white/80 backdrop-blur transition duration-200 hover:-translate-y-0.5 hover:shadow-soft-xl"},React.createElement("div",{className:"aspect-square w-full overflow-hidden bg-slate-100"},React.createElement("img",{src:t,onError:()=>o(nt(a.name)),alt:a.name,className:"h-full w-full object-cover",loading:"lazy"})),React.createElement("div",{className:"flex flex-1 flex-col gap-4 p-5"},React.createElement("header",null,React.createElement("h3",{className:"text-base font-semibold text-slate-900"},a.name),React.createElement("p",{className:"mt-1 text-[11px] font-medium uppercase tracking-[0.18em] text-slate-400"},"SKU ",a.sku)),React.createElement("div",{className:"flex flex-wrap gap-1.5 text-[11px]"},(a.specs||[]).slice(0,4).map(n=>React.createElement("span",{key:n,className:"inline-flex items-center rounded-full border border-[var(--surface-border)] bg-white/80 px-2.5 py-0.5 font-medium text-slate-600"},n))),React.createElement("div",{className:"mt-auto flex items-center justify-between"},React.createElement("span",{className:"text-sm font-semibold text-slate-900"},Be(a.price))),React.createElement("div",null,React.createElement("button",{type:"button",onClick:()=>r(a),className:"w-full rounded-full border border-[rgba(37,99,235,0.28)] bg-white/70 px-4 py-2 text-sm font-semibold text-brand transition hover:bg-brand hover:text-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"View details"))))}function Mr({product:a,onClose:r,onAdd:t,cartItems:o}){const n=a&&a.__edit&&a.product?a.product:a;if(!n)return null;const u=Array.isArray(o)?o:[],i=J(()=>ze(n.inventory),[n.inventory]),E=J(()=>{const b={};return u.forEach(A=>{if(!A||A.id!==n.id)return;const k=A.inventoryKey||Fe(A.variants||{});b[k]=(b[k]||0)+Number(A.qty||0)}),b},[u,n.id]),g=le(null);jt(!!n,g,r);const h=(()=>{const b=Array.isArray(n.images)&&n.images.length?n.images:n.image?[n.image]:[];return(b.length?b:[nt(n.name)]).map(A=>Et(A,n.name))})(),d=n.variants||{},x=Object.entries(d).filter(([,b])=>Array.isArray(b)&&b.length>0).map(([b])=>b),[c,m]=w({}),[M,W]=w({}),[_,B]=w({});T(()=>{if(!n)return;const b={};x.forEach(j=>{const P=d[j]||[];b[j]=P.length?[P[0]]:[]}),m(b);const A=(()=>{if(x.length===0)return[X];const j=[],P=(Q,ie)=>{if(Q===x.length){j.push(Fe(ie));return}const se=x[Q];(b[se]||[]).forEach(me=>P(Q+1,{...ie,[se]:me}))};return P(0,{}),j})(),k={};A.forEach(j=>{k[j]=0}),W(k)},[n]);const G=(b,A)=>m(k=>{const j=k[b]||[],P=j.includes(A)?j.filter(Q=>Q!==A):[...j,A];return{...k,[b]:P}}),H=b=>m(A=>({...A,[b]:[...d[b]||[]]})),$=b=>m(A=>({...A,[b]:[]})),R=(b,A)=>{const k=Math.max(0,Number(A)||0);B(j=>{const P=j[b];if(P===void 0)return j;if(k<P){const Q={...j};return delete Q[b],Q}return j}),W(j=>({...j,[b]:k}))},D=J(()=>{if(x.length===0)return[{key:X,sel:{}}];if(x.some(k=>(c[k]||[]).length===0))return[];const b=[],A=(k,j)=>{if(k===x.length){b.push({key:Fe(j),sel:j});return}const P=x[k];(c[P]||[]).forEach(Q=>A(k+1,{...j,[P]:Q}))};return A(0,{}),b},[x,c]),v=()=>{let b=!1,A=!1;D.forEach(({key:k,sel:j})=>{const P=Number(M[k]||0);if(!(P>0))return;const Q=i[k]!==void 0?i[k]:k===X?i[X]:void 0,ie=E[k]||0,se=typeof Q=="number"?Math.max(Q-ie,0):void 0,me=typeof se=="number"?Math.min(P,se):P;me>0?(t({id:n.id,name:n.name,sku:n.sku,price:n.price,qty:me,variants:j,inventoryKey:k}),b=!0,me<P&&(A=!0)):A=!0}),A&&alert("Some items were adjusted to match available stock."),b&&r()},z=J(()=>D.reduce((b,{key:A})=>{const k=Number(M[A]||0);if(!Number.isFinite(k)||k<=0)return b;const j=i[A]!==void 0?i[A]:A===X?i[X]:void 0,P=E[A]||0,Q=typeof j=="number"?Math.max(j-P,0):void 0,ie=typeof Q=="number"?Math.min(k,Q):k;return ie>0?b+ie*n.price:b},0),[D,M,n.price,i,E]),O=D.every(({key:b})=>{const A=Number(M[b]||0);if(!(A>0))return!0;const k=i[b]!==void 0?i[b]:b===X?i[X]:void 0,j=E[b]||0,P=typeof k=="number"?Math.max(k-j,0):void 0;return!((typeof P=="number"?Math.min(A,P):A)>0)});return T(()=>{B(b=>{const A=new Set(D.map(({key:P})=>P));let k=!1;const j={};return Object.entries(b).forEach(([P,Q])=>{A.has(P)?j[P]=Q:k=!0}),k?j:b})},[D]),T(()=>{B({})},[n.id]),React.createElement("div",{role:"dialog","aria-modal":"true","aria-labelledby":`product-title-${n.id}`,className:"fixed inset-0 z-50 flex items-stretch sm:items-center justify-center bg-black/40 p-0 sm:p-6",onClick:r,onTouchMove:b=>{b.target===b.currentTarget&&b.preventDefault()},onWheel:b=>{b.target===b.currentTarget&&b.preventDefault()}},React.createElement("div",{ref:g,tabIndex:-1,className:"w-full h-full sm:h-auto sm:max-w-3xl rounded-none sm:rounded-3xl border border-[var(--surface-border)] bg-[rgba(255,255,255,0.96)] backdrop-blur-xl shadow-soft-xl outline-none overscroll-contain overflow-y-auto max-h-none sm:max-h-[90vh]",style:{touchAction:"pan-y"},onClick:b=>b.stopPropagation()},React.createElement("div",{className:"flex items-center justify-between border-b border-[var(--surface-border)] bg-white/70 px-5 py-4"},React.createElement("h3",{id:`product-title-${n.id}`,className:"text-lg font-semibold text-slate-900"},n.name),React.createElement("button",{onClick:r,className:"rounded-full border border-transparent p-2 text-slate-500 transition hover:bg-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand","aria-label":"Close"},React.createElement(Ma,{className:"h-5 w-5"}))),React.createElement("div",{className:"grid gap-6 p-5 lg:grid-cols-[minmax(0,1fr)_260px]"},React.createElement("div",{className:"space-y-6"},React.createElement("div",{className:"relative aspect-square w-full overflow-hidden rounded-2xl border border-[var(--surface-border)] bg-slate-100"},React.createElement("img",{src:h[0],onError:b=>{b.currentTarget.src=nt(n.name)},alt:`${n.name} \u2013 photo`,className:"h-full w-full object-cover"})),n.description&&React.createElement("p",{className:"text-sm text-slate-600"},n.description),x.map(b=>{const A=d[b]||[],k=c[b]||[],j=b.toLowerCase().includes("color")||b==="Color";return React.createElement("div",{key:b,className:"rounded-2xl border border-[var(--surface-border)] bg-white/80 p-4 text-sm shadow-sm backdrop-blur"},React.createElement("div",{className:"mb-2 flex flex-wrap items-center justify-between gap-2"},React.createElement("span",{className:"text-sm font-semibold text-slate-900"},b),A.length?React.createElement("div",{className:"flex items-center gap-2 text-xs text-slate-500"},React.createElement("button",{type:"button",onClick:()=>H(b),className:"rounded-full border border-[var(--surface-border)] px-2 py-1 font-medium hover:bg-white/60"},"All"),React.createElement("button",{type:"button",onClick:()=>$(b),className:"rounded-full border border-[var(--surface-border)] px-2 py-1 font-medium hover:bg-white/60"},"Clear")):null),React.createElement("div",{className:"max-h-32 overflow-auto rounded-xl border border-[var(--surface-border)] bg-white/70 p-2"},React.createElement("div",{className:"flex flex-wrap gap-2 text-xs"},A.length===0?React.createElement("p",{className:"text-slate-500"},"No options"):A.map(P=>{const Q=k.includes(P);return React.createElement("button",{type:"button",key:P,onClick:()=>G(b,P),className:Z("inline-flex items-center gap-1 rounded-full border px-3 py-1 font-medium transition focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",Q?"border-transparent bg-brand text-white shadow-sm":"border-[var(--surface-border)] bg-white/80 text-slate-700 hover:text-slate-900 hover:bg-white")},j?React.createElement(st,{name:P}):null,P)}))))}),React.createElement("div",{className:"space-y-3","aria-label":"Quantities"},D.length===0?React.createElement("p",{className:"text-xs text-slate-500"},"Select at least one option."):D.map(({key:b,sel:A})=>{const k=i[b]!==void 0?i[b]:b===X?i[X]:void 0,j=E[b]||0,P=typeof k=="number"?Math.max(k-j,0):void 0,Q=typeof P=="number"&&P<=0,ie=_[b];return React.createElement("div",{key:b,className:Z("rounded-2xl border px-3 py-3 text-sm shadow-sm backdrop-blur sm:flex sm:items-center sm:justify-between",Q?"border-rose-200 bg-rose-50/80 text-rose-700":"border-[var(--surface-border)] bg-white/85 text-slate-700")},React.createElement("div",{className:"space-y-1 text-sm"},Object.entries(A).map(([se,me],ue)=>React.createElement("span",{key:`${se}-${me}`},ue>0?" \xB7 ":"",se==="Color"?React.createElement("span",{className:"inline-flex items-center gap-1"},React.createElement(st,{name:me}),me):React.createElement("span",{className:"font-medium text-slate-900"},me))),Object.keys(A).length===0&&React.createElement("span",{className:"font-medium text-slate-900"},"Quantity"),typeof k=="number"?React.createElement("p",{className:"text-xs text-slate-500"},`Remaining: ${Math.max(k-j,0)}${j>0?` (of ${k})`:""}`):React.createElement("p",{className:"text-xs text-slate-500"},"No stock limit")),React.createElement("div",{className:"mt-2 sm:mt-0"},React.createElement(Ia,{value:Number(M[b]||0),onChange:se=>R(b,se),min:0,max:typeof P=="number"?P:void 0,onLimit:se=>{typeof se=="number"&&Number.isFinite(se)&&B(me=>({...me,[b]:se}))}})),ie!==void 0?React.createElement("p",{className:"mt-2 text-xs font-medium text-rose-600 sm:ml-3 sm:mt-0 sm:text-right"},`Only ${ie} available for this selection.`):null)}))),React.createElement("aside",{className:"glass-card rounded-3xl space-y-5 p-5"},React.createElement("div",{className:"space-y-2 text-sm"},React.createElement("div",{className:"flex items-center justify-between text-slate-500"},React.createElement("span",null,"Unit price"),React.createElement("span",{className:"font-semibold text-slate-900"},Be(n.price))),React.createElement("div",{className:"flex items-center justify-between text-slate-500"},React.createElement("span",null,"Selections"),React.createElement("span",{className:"font-medium text-slate-800"},D.length))),React.createElement("div",{className:"flex items-center justify-between rounded-2xl border border-[rgba(37,99,235,0.28)] bg-[rgba(37,99,235,0.12)] px-4 py-3 text-sm font-medium text-brand"},React.createElement("span",{className:"uppercase tracking-[0.18em]"},"Line total"),React.createElement("span",{className:"text-base font-semibold text-brand"},Be(z))),React.createElement("p",{className:"text-xs text-slate-500"},"Add items to the cart and send the final list to WhatsApp when you are ready."),React.createElement("div",{className:"flex flex-col gap-2"},React.createElement("button",{disabled:O,onClick:v,className:Z("w-full rounded-full bg-brand px-4 py-2 text-sm font-semibold text-white transition focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",O?"pointer-events-none opacity-50":"hover:bg-brand-muted")},"Add to cart"),React.createElement("button",{onClick:r,className:"w-full rounded-full border border-[var(--surface-border)] bg-white/70 px-4 py-2 text-sm font-semibold text-slate-700 transition hover:bg-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"Cancel"))))))}function Ia({id:a,value:r,onChange:t,min:o=0,max:n,onLimit:u}){const i=d=>{typeof n=="number"&&Number.isFinite(n)&&typeof u=="function"&&d>n&&u(n)},E=(d,x)=>{i(typeof x=="number"?x:d);let c=Math.max(o,d);return typeof n=="number"&&Number.isFinite(n)&&(c=Math.min(n,c)),c},g=Number(r)||0,h=typeof n=="number"&&Number.isFinite(n)&&g>=n;return React.createElement("div",{className:"inline-flex items-center rounded-full border border-[var(--surface-border)] bg-white/70 shadow-sm backdrop-blur",role:"group","aria-label":"Quantity"},React.createElement("button",{onClick:()=>t(E((Number(r)||0)-1,(Number(r)||0)-1)),className:"rounded-l-full px-3 py-1.5 text-slate-700 transition hover:bg-brand-soft focus:outline-none focus-visible:outline-2 focus-visible:outline-brand touch-manipulation select-none","aria-label":"Decrease quantity"},"\u2212"),React.createElement("input",{id:a,inputMode:"numeric",pattern:"[0-9]*",value:String(r),onChange:d=>{const x=Number(d.target.value.replace(/[^0-9]/g,"")),c=Number.isFinite(x)?x:o;t(Number.isFinite(x)?E(c,c):o)},className:"w-14 appearance-none border-x border-[var(--surface-border)] bg-transparent px-2 py-1.5 text-center text-base sm:text-sm text-slate-900 focus:outline-none"}),React.createElement("button",{onClick:()=>t(E((Number(r)||0)+1,(Number(r)||0)+1)),className:Z("rounded-r-full px-3 py-1.5 touch-manipulation select-none transition focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",h?"cursor-not-allowed text-slate-300":"text-slate-700 hover:bg-brand-soft"),"aria-label":"Increase quantity",disabled:h},"+"))}async function jr(a){var r;try{if((r=navigator.clipboard)!=null&&r.writeText)return await navigator.clipboard.writeText(a),!0}catch(t){}try{const t=document.createElement("textarea");return t.value=a,t.setAttribute("readonly",""),t.style.position="fixed",t.style.opacity="0",document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t),!0}catch(t){return!1}}function Ir({open:a,onClose:r,cart:t,productLookup:o}){const n=le(null);jt(a,n,r);const u=lr(),i=J(()=>Lr(t.items,t.subtotal,t.notes),[t.items,t.subtotal,t.notes]),E=t.items.some(m=>Number(m.qty)>0),g=`https://wa.me/${Re}?text=${encodeURIComponent(i)}`,h=`whatsapp://send?phone=${Re}&text=${encodeURIComponent(i)}`,d=/Android|iPhone|iPad|iPod|Windows Phone/i.test(navigator.userAgent),[x,c]=w({});return T(()=>{c(m=>{const M=new Set((t.items||[]).map(B=>{if(!B)return null;const G=B.inventoryKey||Fe(B.variants||{});return`${B.id||""}::${G}`}).filter(Boolean));let W=!1;const _={};return Object.entries(m).forEach(([B,G])=>{M.has(B)?_[B]=G:W=!0}),W?_:m})},[t.items]),React.createElement("div",{"aria-live":"polite"},React.createElement("div",{className:Z("fixed inset-0 z-40 bg-black/40 transition-opacity",a?"opacity-100":"pointer-events-none opacity-0"),onClick:r,onTouchMove:m=>{m.preventDefault()},onTouchStart:m=>{m.preventDefault()},onWheel:m=>{m.preventDefault()},"aria-hidden":"true"}),React.createElement("aside",{role:"dialog","aria-modal":"true","aria-labelledby":"cart-title",className:Z("fixed right-0 top-0 z-50 h-full w-full max-w-md transform border-l border-[var(--surface-border)] bg-[rgba(255,255,255,0.96)] backdrop-blur-xl shadow-soft-xl outline-none overscroll-contain",u?"transition-none":"transition-transform duration-200 ease-out",a?"translate-x-0":"translate-x-full")},React.createElement("div",{ref:n,className:"flex h-full flex-col"},React.createElement("div",{className:"flex items-center justify-between border-b border-[var(--surface-border)] bg-white/70 px-5 py-4"},React.createElement("h3",{id:"cart-title",className:"text-lg font-semibold text-slate-900"},"Your cart"),React.createElement("button",{onClick:r,className:"rounded-full p-2 text-slate-500 transition hover:bg-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand","aria-label":"Close cart"},React.createElement(Ma,{className:"h-5 w-5"}))),React.createElement("div",{className:"flex-1 overflow-y-auto p-4",style:{touchAction:"pan-y"}},t.items.length===0?React.createElement("p",{className:"text-sm text-slate-500"},"Your cart is empty."):React.createElement("ul",{className:"space-y-3"},t.items.map((m,M)=>{const W=o&&typeof o.get=="function"?o.get(m.id):void 0,_=W?ze(W.inventory):{},B=m.inventoryKey||Fe(m.variants||{}),G=_[B]!==void 0?_[B]:B===X?_[X]:void 0;let H=0;t.items.forEach((O,b)=>{if(b===M||!O||O.id!==m.id)return;(O.inventoryKey||Fe(O.variants||{}))===B&&(H+=Number(O.qty||0))});const $=typeof G=="number"?Math.max(G-H,0):void 0,R=typeof $=="number"&&m.qty>$,D=typeof $=="number"?`Available: ${$}`:null,v=`${m.id||""}::${B}`,z=x[v];return React.createElement("li",{key:M,className:Z("rounded-2xl border p-3 shadow-sm backdrop-blur transition",R?"border-rose-200 bg-rose-50/80 text-rose-700":"border-[var(--surface-border)] bg-white/80 text-slate-700")},React.createElement("div",{className:"flex items-start justify-between gap-3"},React.createElement("div",null,React.createElement("p",{className:"font-semibold text-slate-900"},m.name),React.createElement("p",{className:"text-xs text-slate-500"},"SKU: ",m.sku),m.variants&&Object.keys(m.variants).length>0&&React.createElement("div",{className:"mt-1 flex flex-wrap gap-1.5"},Object.entries(m.variants).map(([O,b])=>React.createElement("span",{key:O,className:"inline-flex items-center gap-1 rounded-full border border-[var(--surface-border)] bg-white/80 px-2 py-0.5 text-xs font-medium text-slate-600"},O==="Color"?React.createElement(React.Fragment,null,React.createElement(st,{name:b}),`${O}: ${b}`):`${O}: ${b}`))),D&&React.createElement("p",{className:"mt-1 text-xs text-slate-500"},D),z!==void 0?React.createElement("p",{className:"mt-1 text-xs font-medium text-rose-600"},`Only ${z} available for this selection.`):null),React.createElement("button",{onClick:()=>t.removeIndex(M),className:"rounded-full p-1.5 text-slate-500 transition hover:bg-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand","aria-label":`Remove ${m.name}`},React.createElement(hr,{className:"h-4 w-4 text-slate-500"}))),React.createElement("div",{className:"mt-2 flex items-center justify-between"},React.createElement(Ia,{value:m.qty,onChange:O=>{const b=typeof $=="number"?Math.min(O,$):O;t.updateQty(M,b),c(A=>{const k=A[v];if(k===void 0)return A;if(b<k){const j={...A};return delete j[v],j}return A})},min:0,max:typeof $=="number"?$:void 0,onLimit:O=>{typeof O=="number"&&Number.isFinite(O)&&c(b=>({...b,[v]:O}))}}),React.createElement("div",{className:"text-sm text-slate-600"},Be(m.price)," \xD7 ",m.qty," = ",React.createElement("span",{className:"font-semibold text-slate-900"},Be(m.price*m.qty)))))}))),React.createElement("div",{className:"border-t border-[var(--surface-border)] bg-white/60 p-4 backdrop-blur"},React.createElement("div",{className:"flex items-center justify-between text-sm text-slate-600"},React.createElement("span",null,"Subtotal"),React.createElement("span",{className:"font-semibold text-slate-900"},Be(t.subtotal))),React.createElement("label",{className:"mt-3 block text-sm text-slate-600"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"Notes"),React.createElement("textarea",{value:t.notes,onChange:m=>t.setNotes(m.target.value),rows:2,className:"w-full resize-none rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner backdrop-blur focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",placeholder:"Delivery preferences, color mix, etc."})),React.createElement("div",{className:"mt-3 flex gap-3"},React.createElement("button",{onClick:t.clear,className:"flex-1 rounded-full border border-[var(--surface-border)] bg-white/70 px-4 py-2 text-sm font-semibold text-slate-700 transition hover:bg-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"Clear cart"),React.createElement("button",{type:"button",onClick:async()=>{if(!E){alert("Add at least one product before sending an order.");return}if(t.items.filter((B,G)=>{const H=o&&typeof o.get=="function"?o.get(B.id):void 0,$=H?ze(H.inventory):{},R=B.inventoryKey||Fe(B.variants||{}),D=$[R]!==void 0?$[R]:R===X?$[X]:void 0;if(typeof D!="number")return!1;let v=0;t.items.forEach((O,b)=>{if(b===G||!O||O.id!==B.id)return;(O.inventoryKey||Fe(O.variants||{}))===R&&(v+=Number(O.qty||0))});const z=Math.max(D-v,0);return B.qty>z}).length>0){alert("One or more items exceed available stock. Please adjust the quantities before sending the order.");return}try{await dt("createOrder",{currency:Oe,subtotal_cents:Math.round(t.subtotal*100),notes:t.notes||"",items:t.items.map((B,G)=>({product_id:B.id,sku:B.sku,name:B.name,quantity:Number(B.qty)||0,unit_price_cents:Math.round(Number(B.price||0)*100),subtotal_cents:Math.round(Number(B.price||0)*Number(B.qty||0)*100),variants:B.variants||{},inventory_key:B.inventoryKey||Fe(B.variants||{})}))})}catch(B){console.error("Failed to record order",B)}try{await jr(i),alert("\u2705 Your list is copied! If WhatsApp doesn't open, you can paste it manually.")}catch(B){alert("\u{1F4CB} Please copy your order manually if WhatsApp doesn't open automatically.")}let M=!1;const W=()=>{M||(M=!0,t.clear(),t.setNotes(""))},_=()=>W();if(window.addEventListener("pagehide",_,{once:!0}),document.addEventListener("visibilitychange",function B(){document.hidden&&(W(),document.removeEventListener("visibilitychange",B))},{once:!0}),d)W(),window.location.href=h,setTimeout(()=>{try{window.open(g,"_blank","noopener,noreferrer")}catch(B){}},800);else{const B=window.open(g,"_blank","noopener,noreferrer");setTimeout(W,500)}},className:Z("flex-1 inline-flex items-center justify-center gap-2 rounded-full px-4 py-2 text-sm font-semibold text-white shadow-sm focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",E?"bg-brand hover:bg-brand-muted":"pointer-events-none bg-[rgba(37,99,235,0.28)] text-white/70")},"Send via WhatsApp",React.createElement(ja,{className:"h-4 w-4 text-white"})))))))}function Lr(a,r,t){const o=(a||[]).filter(u=>Number(u.qty)>0);let n=`\u{1F6D2} *Order Request*

`;return o.forEach(u=>{n+=`\u2022 ${u.name} (SKU: ${u.sku})
`,u.variants&&Object.keys(u.variants).length>0&&(n+=`  Variants: ${Object.entries(u.variants).map(([i,E])=>`${i}: ${E}`).join(", ")}
`),n+=`  Qty: ${u.qty} \xD7 ${Be(u.price)} = ${Be(u.price*u.qty)}

`}),n+=`*Subtotal: ${Be(r)}*

`,(t||"").trim()&&(n+=`*Notes:* ${t.trim()}

`),n+="Please confirm availability and pricing. Thank you!",n}function Tr({addProduct:a,onNotify:r,catalogConfig:t,saveCatalogConfig:o}){var La;const n=Array.isArray(t==null?void 0:t.categories)&&t.categories.length?t.categories:At.filter(e=>e!=="All"),u=Array.isArray(t==null?void 0:t.families)&&t.families.length?t.families:Zt().families,[i,E]=w(n[0]||"Phone Screens"),[g,h]=w(((La=u[0])==null?void 0:La.id)||"iphone"),d=u.find(e=>e&&e.id===g)||u[0]||{name:"iPhone",models:rt},x=Array.isArray(d==null?void 0:d.models)?d.models:[];T(()=>{n.includes(i)||E(n[0]||"Phone Screens")},[n]),T(()=>{var e;u.some(s=>s&&s.id===g)||h(((e=u[0])==null?void 0:e.id)||"iphone")},[u]);const[c,m]=w("");T(()=>{m(e=>{const s=new Set(n),p=(e||"").trim(),y=s.has(p.replace(" \u2014",""))||p.endsWith(" \u2014");return!p||y?`${i} \u2014 `:e})},[i,n]);const[M,W]=w(""),[_,B]=w(""),[G,H]=w(""),[$,R]=w([]),[D,v]=w([]),[z,O]=w(null),[b,A]=w(!1),[k,j]=w({}),[P,Q]=w(!1),[ie,se]=w(""),[me,ue]=w({}),[_e,We]=w(!1),[$e,ve]=w({}),ke=e=>String(e||"").toLowerCase().includes("multi"),Me=e=>ke(e==null?void 0:e.mode),ut=e=>ke(e)?"multi":"single",qe=e=>e==="familyModels"?"familyModels":"static",F=(e,s)=>{if(!e||typeof e!="object")return e;const p={...e};return p.mode=ut(e.mode),p.optionsSource=qe(e.optionsSource),p.options=Array.isArray(e.options)?e.options:[],s==="customer"?p.fieldType="select":p.fieldType=e.fieldType==="checkbox"?"checkbox":"select",p},ee=e=>({info:((e==null?void 0:e.info)||[]).map(s=>F(s,"info")).filter(Boolean),customer:((e==null?void 0:e.customer)||[]).map(s=>F(s,"customer")).filter(Boolean)}),te=()=>{var p;const e=(p=t==null?void 0:t.groupOverridesByCategoryFamily)==null?void 0:p[i],s=e==null?void 0:e[g];return!s||typeof s!="object"?null:{info:s.info&&typeof s.info=="object"?s.info:{},customer:s.customer&&typeof s.customer=="object"?s.customer:{}}},we=()=>{var p;const e=(p=t==null?void 0:t.groupHiddenByCategoryFamily)==null?void 0:p[i],s=e==null?void 0:e[g];return!s||typeof s!="object"?{info:[],customer:[]}:{info:Array.isArray(s.info)?s.info:[],customer:Array.isArray(s.customer)?s.customer:[]}},ot=e=>{const s=te(),p=we(),y=(S,L)=>{const V=new Set(((p==null?void 0:p[L])||[]).map(Y=>String(Y))),U=(s==null?void 0:s[L])||{},ae=(Array.isArray(S)?S:[]).filter(Y=>Y&&!V.has(String(Y.id))).map(Y=>{const ce=U[String(Y.id)];return F(ce&&typeof ce=="object"?{...Y,...ce}:Y,L)});return Object.keys(U||{}).forEach(Y=>{if(V.has(String(Y))||ae.some(de=>String(de.id)===String(Y)))return;const ce=U[Y];ce&&typeof ce=="object"&&ae.push(F({id:Y,...ce},L))}),ae.filter(Boolean)};return{info:y(e==null?void 0:e.info,"info"),customer:y(e==null?void 0:e.customer,"customer")}},xe=(e,s)=>{v([]),O(null),j(p=>({...p,[e]:s}))},Ye=(e,s)=>j(p=>{v([]),O(null);const y=Array.isArray(p[e])?p[e]:[];return{...p,[e]:y.includes(s)?y.filter(S=>S!==s):[...y,s]}});function bt(e){v([]),O(null);const s=Array.from(e.target.files||[]);if(!s.length)return;const p=s.map(y=>new Promise(S=>{const L=new FileReader;L.onload=()=>S(String(L.result||"")),L.readAsDataURL(y)}));Promise.all(p).then(y=>R(S=>[...S,...y]))}const je=e=>Array.isArray(e)&&e.length?e[0]:e!=null?e:"",Nt={"Phone Screens":{must:[{key:"models",label:"Phone models",type:"phoneModels"},{key:"display",label:"Display type/quality",type:"select",options:["OLED \u2013 OEM","OLED \u2013 AAA","LCD \u2013 OEM","LCD \u2013 AAA"]},{key:"frame",label:"Frame",type:"select",options:["With frame","Without frame"]}],also:[{key:"frontColor",label:"Front color",type:"select",options:["Black","White"]},{key:"retention",label:"True Tone/Face ID retention",type:"checkbox"}],optional:[{key:"adhesive",label:"Pre-installed adhesive / waterproof gasket",type:"checkbox"}],name:e=>`Screen \u2014 ${je(e.models)} ${e.display?`${String(e.display).split(" ")[0]}`:""}`.trim(),specs:e=>[e.display,e.frame,e.frontColor].filter(Boolean)},"Back Glass":{must:[{key:"models",label:"Phone models",type:"phoneModels"},{key:"colors",label:"Colors / finish",type:"multiselect",options:wt}],also:[{key:"adhesive",label:"Adhesive pre-installed",type:"checkbox"},{key:"rings",label:"With camera rings",type:"checkbox"}],optional:[{key:"grade",label:"Quality grade",type:"select",options:wa}],name:e=>`Back Glass \u2014 ${je(e.models)}`.trim(),specs:e=>[je(e.colors)||null,e.grade,e.adhesive?"Adhesive":null,e.rings?"Camera rings":null].filter(Boolean)},"Power Banks":{must:[{key:"capacity",label:"Capacity",type:"select",options:sr},{key:"ports",label:"Output ports",type:"select",options:Ra}],also:[{key:"standard",label:"Standard",type:"select",options:mt}],optional:[{key:"colour",label:"Colour",type:"select",options:wt}],name:e=>`Power bank \u2014 ${e.capacity||""}`.trim(),specs:e=>[e.capacity,e.ports,e.standard].filter(Boolean)},"Screen Protectors":{must:[{key:"models",label:"Phone models",type:"phoneModels"},{key:"material",label:"Material",type:"select",options:za},{key:"pack",label:"Pack",type:"select",options:Ya}],also:[{key:"finish",label:"Finish",type:"select",options:qa},{key:"coverage",label:"Coverage",type:"select",options:Va}],optional:[],name:e=>`Protector \u2014 ${je(e.models)} ${e.material?`(${e.material})`:""}`.trim(),specs:e=>[e.material,e.finish,e.coverage].filter(Boolean)},Batteries:{must:[{key:"models",label:"Phone models",type:"phoneModels"},{key:"grade",label:"Grade",type:"select",options:wa}],also:[],optional:[{key:"capacity",label:"Capacity (mAh)",type:"text",placeholder:"e.g. 3000"}],name:e=>`Battery \u2014 ${je(e.models)}`.trim(),specs:e=>[e.grade,e.capacity].filter(Boolean)},"Mobile Phones":{must:[{key:"model",label:"Model",type:"text",placeholder:"e.g., iPhone 13"},{key:"cond",label:"Condition/grade",type:"select",options:ka},{key:"sim",label:"SIM",type:"select",options:er}],also:[{key:"connect",label:"Connectivity",type:"select",options:tr},{key:"warranty",label:"Warranty (months)",type:"number"}],optional:[{key:"storage",label:"Storage",type:"multiselect",options:Sa},{key:"ram",label:"RAM",type:"multiselect",options:Aa},{key:"color",label:"Color",type:"text"},{key:"inbox",label:"Accessories in box",type:"text",placeholder:"Cable, charger"}],name:e=>`${e.model||""} ${e.cond||""}`.trim(),specs:e=>[Array.isArray(e.storage)&&e.storage[0]||null,Array.isArray(e.ram)&&e.ram[0]||null,e.cond,e.sim,e.connect].filter(Boolean)},Tablets:{must:[{key:"model",label:"Model",type:"text",placeholder:"iPad 10th Gen"},{key:"conn",label:"Connectivity",type:"select",options:ar}],also:[{key:"screen",label:"Screen size",type:"text",placeholder:'10.9"'},{key:"warranty",label:"Warranty (months)",type:"number"}],optional:[{key:"storage",label:"Storage",type:"multiselect",options:Sa},{key:"ram",label:"RAM",type:"multiselect",options:Aa},{key:"cond",label:"Condition/grade",type:"select",options:ka},{key:"color",label:"Color",type:"text"},{key:"compat",label:"Pencil/keyboard compatibility",type:"text"}],name:e=>`${e.model||""} ${e.conn||""}`.trim(),specs:e=>[Array.isArray(e.storage)&&e.storage[0]||null,Array.isArray(e.ram)&&e.ram[0]||null,e.conn,e.screen,e.cond].filter(Boolean)},"Phone Cases":{must:[{key:"models",label:"Phone models",type:"phoneModels"},{key:"material",label:"Material",type:"select",options:Ha}],also:[{key:"color",label:"Color",type:"multiselect",options:wt}],optional:[{key:"pattern",label:"Pattern / style",type:"text"}],name:e=>`Case \u2014 ${je(e.models)} ${e.material?`(${e.material})`:""}`.trim(),specs:e=>[e.material,je(e.color)||null].filter(Boolean)},Cables:{must:[{key:"connector",label:"Connector",type:"select",options:Xt},{key:"length",label:"Length",type:"select",options:Ea}],also:[{key:"rating",label:"Power rating",type:"select",options:Na},{key:"durability",label:"Durability",type:"select",options:Ja}],optional:[{key:"cert",label:"Certs",type:"select",options:Qa}],name:e=>`Cable \u2014 ${e.connector||""} ${e.length?`(${e.length})`:""}`.trim(),specs:e=>[e.connector,e.length,e.rating].filter(Boolean)},Chargers:{must:[{key:"wattage",label:"Wattage",type:"select",options:Za||["20W","30W","45W","65W"]},{key:"ports",label:"Ports",type:"select",options:Ra}],also:[{key:"standard",label:"Standard",type:"select",options:mt},{key:"plug",label:"Plug type",type:"select",options:Xa}],optional:[],name:e=>`Charger \u2014 ${e.wattage||""}`.trim(),specs:e=>[e.wattage,e.ports].filter(Boolean)},Earphones:{must:[{key:"type",label:"Type",type:"select",options:["Wired","TWS"]}],also:[{key:"connector",label:"Connector / Standard",type:"select",options:[...Xt,...mt]}],optional:[{key:"color",label:"Color",type:"select",options:wt}],name:e=>`Earphones \u2014 ${e.type||""}`.trim(),specs:e=>[e.type,e.connector].filter(Boolean)},"Charging Ports":{must:[{key:"models",label:"Phone models",type:"phoneModels"},{key:"type",label:"Port type",type:"select",options:["USB-C","Lightning","Micro-USB"]}],also:[],optional:[{key:"solderRequired",label:"Solder required",type:"checkbox"}],name:e=>`Charging port \u2014 ${je(e.models)}`.trim(),specs:e=>[e.type,e.solderRequired?"Solder":null].filter(Boolean)},"Face ID":{must:[{key:"models",label:"Phone models",type:"phoneModels",allowedBrands:["iPhone"]},{key:"service",label:"Service",type:"select",options:["Repair","Replace","Calibration"]}],also:[],optional:[],name:e=>`Face ID \u2014 ${je(e.models)}`.trim(),specs:e=>[e.service].filter(Boolean)}},Lt=e=>{const s=Nt[e]||{must:[],also:[],optional:[]},p=[...s.must||[],...s.also||[],...s.optional||[]],y={info:[],customer:[]};return p.forEach(S=>{if(!S||!S.key)return;const L={id:S.key,label:S.label,schemaKey:S.key,fieldType:S.type,options:Array.isArray(S.options)?S.options:[]};if(S.type==="phoneModels"){y.customer.push({...L,key:"Model",mode:"multi",optionsSource:"familyModels"});return}if(S.type==="multiselect"){y.customer.push({...L,key:Jt(S.label,S.key),mode:"multi",optionsSource:"static"});return}y.info.push({...L,mode:S.type==="multiselect"?"multi":"single",optionsSource:"static"})}),y},Tt=()=>{var s;const e=(s=t==null?void 0:t.groupsByCategory)==null?void 0:s[i];return e&&e.info&&e.customer?e:null},fe=J(()=>{const e=Tt(),s=ee(e||Lt(i)),p=ot(s),y=(p.customer||[]).map(S=>S&&S.key==="Model"?{...S,label:`${(d==null?void 0:d.name)||"Phone"} models`}:S);return{...p,customer:y}},[t,i,g]),Rt=async e=>{const s=Bt(t);s.groupsByCategory=s.groupsByCategory||{},s.groupsByCategory[i]=e,await o(s)},Se=async()=>{const e=Tt();if(e)return e;const s=Lt(i);return await Rt(s),s};T(()=>{const e={};(fe.info||[]).forEach(s=>{!s||!s.schemaKey||(s.fieldType==="select"||s.fieldType==="number"||s.fieldType==="text"?e[s.schemaKey]="":s.fieldType==="checkbox"?e[s.schemaKey]=!1:Me(s)?e[s.schemaKey]=[]:e[s.schemaKey]="")}),(fe.customer||[]).forEach(s=>{!s||!s.schemaKey||(Me(s)?e[s.schemaKey]=[]:e[s.schemaKey]="")}),j(e)},[i,fe]);const[Ae,be]=w(null),[he,Ve]=w({scope:"info",id:null,label:"",key:"",mode:"single",fieldType:"select",optionsSource:"static",optionsText:""}),[ra,Qe]=w(""),[sa,Ft]=w(""),[Wt,Je]=w(""),[Ie,Ue]=w({id:null,name:"",modelsText:""}),na=e=>{try{return JSON.parse(JSON.stringify(e))}catch(s){return e}},oa=e=>String(e||"").toLowerCase().trim().replace(/[^a-z0-9]+/g,"_").replace(/^_+|_+$/g,""),Ze=async e=>{const s=Bt(t),p=na(s),y=(typeof e=="function"?e(p):p)||p;await o(y)},la=()=>{Ue({id:null,name:"",modelsText:""}),be({type:"family"})},ia=()=>{Je(""),be({type:"category"})},Dt=async()=>{const e=String(Wt||"").trim();e&&(await Ze(s=>{const p=Array.isArray(s.categories)?[...s.categories]:[];return p.includes(e)||p.push(e),s.categories=p,s}),E(e),Je(""),be(null))},$t=async e=>{const s=String(e||"").trim();s&&confirm(`Remove category "${s}"? Existing products will still keep their category text.`)&&await Ze(p=>(p.categories=(Array.isArray(p.categories)?p.categories:[]).filter(y=>y!==s),p))},pt=e=>{const s=Array.isArray(e==null?void 0:e.models)?e.models:[];Ue({id:(e==null?void 0:e.id)||null,name:(e==null?void 0:e.name)||"",modelsText:s.join(`
`)})},Ut=async()=>{const e=String(Ie.name||"").trim();if(!e)return;const s=String(Ie.modelsText||"").split(`
`).map(L=>L.trim()).filter(Boolean),p=Array.from(new Set(s)),y=Ie.id?String(Ie.id):null;let S=y||oa(e)||`family_${Date.now()}`;await Ze(L=>{const V=Array.isArray(L.families)?[...L.families]:[];if(y)return L.families=V.map(U=>U&&U.id===y?{...U,name:e,models:p}:U),L;{const U=S;let ae=2;for(;V.some(Y=>Y&&Y.id===S);)S=`${U}_${ae++}`;V.push({id:S,name:e,models:p})}return L.families=V,L}),h(S),Ue({id:null,name:"",modelsText:""}),be(null)},l=async e=>{const s=String((e==null?void 0:e.id)||"").trim(),p=String((e==null?void 0:e.name)||"").trim();s&&confirm(`Remove family "${p||s}"? Existing products will still keep their family meta.`)&&await Ze(y=>(y.families=(Array.isArray(y.families)?y.families:[]).filter(S=>S&&S.id!==s),y))},f=async e=>{await Se(),Qe(""),Ft(""),Ve({scope:e,id:null,label:"",key:"",mode:e==="customer"?"multi":"single",fieldType:"select",optionsSource:"static",optionsText:""}),be({type:"group"})},N=async(e,s)=>{await Se(),Qe(""),Ft("");const p=e==="info"&&s.fieldType==="checkbox",y=p?`Yes
No`:(Array.isArray(s.options)?s.options:[]).join(`
`);Ve({scope:e,id:s.id,label:s.label||"",key:s.key||"",mode:p?"single":ke(s.mode)?"multi":"single",fieldType:"select",optionsSource:s.optionsSource||"static",optionsText:y}),be({type:"group"})},C=e=>Array.from(new Set(String(e||"").split(/[,;\n]/g).map(s=>s.trim()).filter(Boolean))),I=e=>{const s=Array.from(new Set((Array.isArray(e)?e:[]).map(p=>String(p).trim()).filter(Boolean)));Ve(p=>({...p,optionsText:s.join(`
`)}))},q=()=>{},Le=()=>{},Xe=async(e,s)=>{await Se();const p=String((s==null?void 0:s.id)||"").trim();p&&(await Ze(y=>{y.groupHiddenByCategoryFamily=y.groupHiddenByCategoryFamily&&typeof y.groupHiddenByCategoryFamily=="object"?y.groupHiddenByCategoryFamily:{},y.groupOverridesByCategoryFamily=y.groupOverridesByCategoryFamily&&typeof y.groupOverridesByCategoryFamily=="object"?y.groupOverridesByCategoryFamily:{},y.groupHiddenByCategoryFamily[i]=y.groupHiddenByCategoryFamily[i]||{},y.groupHiddenByCategoryFamily[i][g]=y.groupHiddenByCategoryFamily[i][g]||{info:[],customer:[]};const S=e==="customer"?"customer":"info",L=Array.isArray(y.groupHiddenByCategoryFamily[i][g][S])?y.groupHiddenByCategoryFamily[i][g][S]:[];L.includes(p)||L.push(p),y.groupHiddenByCategoryFamily[i][g][S]=L,y.groupOverridesByCategoryFamily[i]=y.groupOverridesByCategoryFamily[i]||{},y.groupOverridesByCategoryFamily[i][g]=y.groupOverridesByCategoryFamily[i][g]||{info:{},customer:{}};const V=y.groupOverridesByCategoryFamily[i][g][S];return V&&typeof V=="object"&&delete V[p],y}),j(y=>{const S={...y},L=s.schemaKey||s.id;return delete S[L],S}))},lt=async()=>{var ce,de;const e=await Se(),s=he.scope,p=String(he.label||"").trim();if(!p){Qe("Group name is required.");return}const y=he.mode==="multi"?"multi":"single",S=he.optionsSource==="familyModels"?"familyModels":"static",L=S==="familyModels"?[]:C(he.optionsText);if(s==="info"&&S!=="familyModels"&&L.length===0){Qe("Add at least one option (comma or new line).");return}const V=!he.id,U=he.id||`og_${Date.now()}`,ae=V?U:(ce=(e[s]||[]).find(K=>String(K.id)===String(U)))==null?void 0:ce.schemaKey,Y={id:U,label:p,schemaKey:ae||U,fieldType:"select",options:L,optionsSource:S,mode:y};if(s==="customer"){const K=V?"":(de=(e.customer||[]).find(re=>re&&String(re.id)===String(U)))==null?void 0:de.key;Y.key=String(K||"").trim()||Jt(p,U)}if(V){const re=[...s==="customer"?e.customer||[]:e.info||[],Y];if(s==="customer"&&y==="multi"&&re.filter(tt=>ke(tt==null?void 0:tt.mode)).length>2){Qe("Only 2 customer option groups can be MULTI. Change another group to SINGLE first.");return}const ge=s==="customer"?{...e,customer:re}:{...e,info:re};await Rt(ge)}else{if(s==="customer"&&y==="multi"&&(Array.isArray(fe.customer)?fe.customer:[]).map(pe=>String(pe.id)===String(U)?{...pe,...Y}:pe).filter(pe=>ke(pe==null?void 0:pe.mode)).length>2){Qe("Only 2 customer option groups can be MULTI. Change another group to SINGLE first.");return}await Ze(K=>{K.groupOverridesByCategoryFamily=K.groupOverridesByCategoryFamily&&typeof K.groupOverridesByCategoryFamily=="object"?K.groupOverridesByCategoryFamily:{},K.groupHiddenByCategoryFamily=K.groupHiddenByCategoryFamily&&typeof K.groupHiddenByCategoryFamily=="object"?K.groupHiddenByCategoryFamily:{},K.groupOverridesByCategoryFamily[i]=K.groupOverridesByCategoryFamily[i]||{},K.groupOverridesByCategoryFamily[i][g]=K.groupOverridesByCategoryFamily[i][g]||{info:{},customer:{}};const re=s==="customer"?"customer":"info";K.groupOverridesByCategoryFamily[i][g][re]=K.groupOverridesByCategoryFamily[i][g][re]||{},K.groupOverridesByCategoryFamily[i][g][re][String(U)]=Y,K.groupHiddenByCategoryFamily[i]=K.groupHiddenByCategoryFamily[i]||{},K.groupHiddenByCategoryFamily[i][g]=K.groupHiddenByCategoryFamily[i][g]||{info:[],customer:[]};const ge=Array.isArray(K.groupHiddenByCategoryFamily[i][g][re])?K.groupHiddenByCategoryFamily[i][g][re]:[];return K.groupHiddenByCategoryFamily[i][g][re]=ge.filter(pe=>String(pe)!==String(U)),K})}be(null)},ca=({f:e})=>{var y,S;if(!e)return null;const s="mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500",p="w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner backdrop-blur focus:outline-none focus-visible:outline-2 focus-visible:outline-brand";if(e.type==="select")return React.createElement("label",{className:"block text-sm text-slate-600 space-y-1"},React.createElement("span",{className:s},e.label),React.createElement("select",{value:(y=k[e.key])!=null?y:"",onChange:L=>xe(e.key,L.target.value),className:p},(e.options||[]).map(L=>React.createElement("option",{key:L,value:L},L))));if(e.type==="text"||e.type==="number")return React.createElement("label",{className:"block text-sm text-slate-600 space-y-1"},React.createElement("span",{className:s},e.label),React.createElement("input",{type:e.type,value:(S=k[e.key])!=null?S:"",onChange:L=>xe(e.key,e.type==="number"?L.target.value.replace(/[^0-9.]/g,""):L.target.value),placeholder:e.placeholder||"",className:p}));if(e.type==="checkbox")return React.createElement("label",{className:"inline-flex items-center gap-3 rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3 py-2 text-sm text-slate-600 shadow-sm backdrop-blur"},React.createElement("input",{type:"checkbox",checked:!!k[e.key],onChange:L=>xe(e.key,L.target.checked),className:"h-4 w-4 rounded border-[var(--surface-border)] text-brand focus:ring-brand"}),React.createElement("span",null,e.label));if(e.type==="multiselect"){const L=e.options||[],V=Array.isArray(k[e.key])?k[e.key]:[];return React.createElement("div",{className:"space-y-2 rounded-2xl border border-[var(--surface-border)] bg-white/70 p-4 text-sm text-slate-600 shadow-sm backdrop-blur"},React.createElement("div",{className:"flex items-center justify-between"},React.createElement("span",{className:"text-sm font-semibold text-slate-800"},e.label),React.createElement("div",{className:"flex items-center gap-2 text-xs"},React.createElement("button",{type:"button",onClick:()=>xe(e.key,L),className:"rounded-full border border-[var(--surface-border)] px-2 py-0.5 font-medium text-slate-600 hover:bg-white/60",title:"Select all"},"All"),React.createElement("button",{type:"button",onClick:()=>xe(e.key,[]),className:"rounded-full border border-[var(--surface-border)] px-2 py-0.5 font-medium text-slate-600 hover:bg-white/60",title:"Clear"},"Clear"))),React.createElement("div",{className:"flex flex-wrap gap-1.5 text-xs"},L.map(U=>{const ae=V.includes(U),Y=_t[U]!==void 0||/color/i.test(e.label);return React.createElement("button",{type:"button",key:U,onClick:()=>Ye(e.key,U),className:Z("inline-flex items-center gap-1 rounded-full border px-2.5 py-1 font-medium transition",ae?"border-transparent bg-brand text-white shadow-sm":"border-[var(--surface-border)] bg-white/80 text-slate-700 hover:text-slate-900 hover:bg-white")},Y?React.createElement(React.Fragment,null,React.createElement(st,{name:U}),U):U)})))}if(e.type==="phoneModels"){const L=x,V=Array.isArray(k[e.key])?k[e.key]:[];return React.createElement("div",{className:"space-y-3 rounded-2xl border border-[var(--surface-border)] bg-white/70 p-4 text-sm text-slate-600 shadow-sm backdrop-blur"},React.createElement("div",{className:"flex items-center justify-between text-xs text-slate-500"},React.createElement("span",{className:"font-semibold text-slate-800"},`${(d==null?void 0:d.name)||"Phone"} models`),React.createElement("div",{className:"flex items-center gap-2"},React.createElement("button",{type:"button",onClick:()=>xe(e.key,L),className:"rounded-full border border-[var(--surface-border)] px-2 py-0.5 font-medium hover:bg-white/60",title:"Select all"},"All"),React.createElement("button",{type:"button",onClick:()=>xe(e.key,[]),className:"rounded-full border border-[var(--surface-border)] px-2 py-0.5 font-medium hover:bg-white/60",title:"Clear"},"Clear"))),React.createElement("div",{className:"flex flex-wrap gap-1.5 text-xs"},L.map(U=>{const ae=V.includes(U),Y=String(U).startsWith("iPhone ")?String(U).replace("iPhone ",""):U;return React.createElement("button",{type:"button",key:U,onClick:()=>{const ce=Array.isArray(k[e.key])?k[e.key]:[];xe(e.key,ae?ce.filter(de=>de!==U):[...ce,U])},className:Z("rounded-full border px-2.5 py-1 font-medium transition",ae?"border-transparent bg-brand text-white shadow-sm":"border-[var(--surface-border)] bg-white/80 text-slate-700 hover:text-slate-900 hover:bg-white")},Y)})))}return null},et=e=>e.schemaKey||e.id,kt=e=>e?e.optionsSource==="familyModels"?x:Array.isArray(e.options)?e.options:[]:[],ft=J(()=>{const e={};return(fe.customer||[]).forEach(s=>{if(!s)return;const p=s.key||Jt(s.label,s.schemaKey||s.id),y=et(s),S=k[y];if(Me(s)){const ae=(Array.isArray(S)?S:S==null?[]:[S]).map(Y=>String(Y).trim()).filter(Boolean);ae.length&&(e[p]=Array.from(new Set(ae)));return}const L=Array.isArray(S)?S[0]:S,V=String(L||"").trim();V&&(e[p]=[V])}),e},[fe,k]),it=J(()=>ba(ft).slice().sort((s,p)=>s.key.localeCompare(p.key)),[ft]),Ce=J(()=>it.map(e=>e.key),[it]);T(()=>{P&&ue(e=>{const s={};Ce.forEach(y=>{s[y]=Object.prototype.hasOwnProperty.call(e,y)?e[y]:""});const p=Object.keys(e);return p.length===Ce.length&&p.every(y=>Object.prototype.hasOwnProperty.call(s,y)&&s[y]===e[y])?e:s})},[P,Ce]),T(()=>{_e&&ve(e=>{const s={};Ce.forEach(y=>{s[y]=Object.prototype.hasOwnProperty.call(e,y)?e[y]:""});const p=Object.keys(e);return p.length===Ce.length&&p.every(y=>Object.prototype.hasOwnProperty.call(s,y)&&s[y]===e[y])?e:s})},[_e,Ce]);const ne=()=>{const e=Number(ie);if(!Number.isFinite(e)||e<0)return;const s=String(Math.floor(e));ue(p=>{const y={...p};return Ce.forEach(S=>{y[S]=s}),y})},oe=()=>{ue(e=>{const s={...e};return Ce.forEach(p=>{s[p]=""}),s}),se("")},Ee=()=>{const e=Number(_);if(!Number.isFinite(e)||e<0)return;const s=String(e);ve(p=>{const y={...p};return Ce.forEach(S=>{S!==X&&(y[S]=s)}),y})},Te=()=>{ve(e=>{const s={...e};return Ce.forEach(p=>{s[p]=""}),s})},Ne=e=>{const s=Object.entries(e||{}).filter(([p,y])=>y!=null&&String(y).trim()!=="").sort(([p],[y])=>p.localeCompare(y));return s.length?s.map(([p,y])=>`${p}: ${y}`).join(" \u2022 "):"Base product"},Gt=()=>{const e=Nt[i]||{must:[],also:[],optional:[],name:null,specs:null},s=e.name&&e.name(k)||`${i} item`,p=c.trim()||s,y={...ft||{}},S={};if(P&&Object.entries(me||{}).forEach(([de,K])=>{const re=String(K!=null?K:"").trim();if(!re)return;const ge=Number(re);!Number.isFinite(ge)||ge<0||(S[de&&de.trim()||X]=Math.floor(ge))}),_e){const de=Number(_),K=Number.isFinite(de)?de:0,re={};Object.entries($e||{}).forEach(([ge,pe])=>{if(ge===X)return;const tt=String(pe!=null?pe:"").trim();if(!tt)return;const Kt=Number(tt);!Number.isFinite(Kt)||Kt<0||Math.abs(Kt-K)<1e-9||(re[ge&&ge.trim()||X]=Kt)}),Object.keys(re).length&&(y[He]=re)}const L=[];(fe.info||[]).forEach(de=>{if(!de)return;const K=et(de),re=String(de.label||de.key||de.id||"").trim();if(de.fieldType==="checkbox"){k[K]&&L.push(re||de.label);return}if(Me(de)){const pe=Array.isArray(k[K])?k[K].map(tt=>String(tt).trim()).filter(Boolean):[];if(!pe.length)return;L.push(re?`${re}: ${pe.join(", ")}`:pe.join(", "));return}const ge=String(k[K]||"").trim();ge&&L.push(re?`${re}: ${ge}`:ge)});const V=String((d==null?void 0:d.name)||"").trim(),ae=[...V?[`${vt}${V}`]:[],...Array.from(new Set(L)).filter(Boolean)],Y=Array.from(new Set(($||[]).filter(Boolean))),ce={id:`owner-${Date.now()}`,name:p,sku:M.trim()||`SKU-${(Math.random()*1e6|0).toString(36)}`,category:i,price:Number(_)||0,description:G.trim(),image:Y[0]||void 0,images:Y.length?Y:void 0,specs:ae,variants:y,inventory:P?S:void 0};return ye(ce)},yt=()=>{var L;const e=[],s=Nt[i]||{must:[]},p=Number(_);(!Number.isFinite(p)||p<=0)&&e.push("Price must be greater than 0");const y=(fe.customer||[]).find(V=>V&&(V.key==="Model"||V.schemaKey==="models"));if(y){const V=et(y),U=k[V];Me(y)?(Array.isArray(U)?U:[]).length===0&&e.push("Please select at least one model"):String(U||"").trim()||e.push("Please select a model")}const S=(s.must||[]).find(V=>V.key==="model");return S&&(String((L=k[S.key])!=null?L:"").trim()||e.push("Model is required")),P&&Object.entries(me||{}).find(([U,ae])=>{const Y=String(ae!=null?ae:"").trim();if(!Y)return!1;const ce=Number(Y);return!Number.isFinite(ce)||ce<0})&&e.push("Stock quantities must be 0 or greater (or leave blank for unlimited)."),_e&&Object.entries($e||{}).find(([U,ae])=>{if(U===X)return!1;const Y=String(ae!=null?ae:"").trim();if(!Y)return!1;const ce=Number(Y);return!Number.isFinite(ce)||ce<0})&&e.push("Price overrides must be 0 or greater (or leave blank to use the base price)."),e},Ur=async()=>{const e=yt();if(e.length){v(e),O(null);return}const s=Gt();if(s){A(!0);try{const p=await a(s),y=!!(p&&p.persisted);v([]),y?O({type:"success",message:"Product added to catalogue."}):(O({type:"warning",message:"Product saved locally. Supabase sync pending."}),r==null||r("warning","Supabase connection unavailable. Product stored locally until sync succeeds.")),m(`${i} \u2014 `),W(""),B(""),H(""),R([]),j({}),Q(!1),se(""),ue({}),We(!1),ve({})}catch(p){console.error("Failed to add product:",p),O({type:"error",message:"Could not save product. Check your connection and try again."}),r==null||r("error","Could not add product. Check your connection and try again.")}finally{A(!1)}}};return React.createElement("section",{"aria-labelledby":"owner-title",className:"mx-auto max-w-6xl px-4 sm:px-6 lg:px-8 py-8"},React.createElement("div",{className:"space-y-6 rounded-3xl border border-[var(--surface-border)] bg-white/95 p-6 sm:p-8 shadow-soft-xl"},React.createElement("div",{className:"space-y-2"},React.createElement("h2",{id:"owner-title",className:"text-2xl font-semibold text-slate-900"},"Owner \u2014 Add products"),React.createElement("p",{className:"text-sm text-slate-600"},"Only essentials. Fields shift by category. Keep data clean; the catalogue updates instantly.")),z&&React.createElement("div",{className:Z("rounded-2xl border px-4 py-3 text-sm shadow-sm",z.type==="error"?"border-rose-200 bg-rose-50/80 text-rose-700":z.type==="warning"?"border-amber-200 bg-amber-50/80 text-amber-700":"border-emerald-200 bg-emerald-50/80 text-emerald-700")},z.message),D.length>0&&React.createElement("div",{className:"rounded-2xl border border-amber-200 bg-amber-50/80 px-4 py-3 text-sm text-amber-700 shadow-sm"},React.createElement("p",{className:"font-semibold"},"Please fix the following:"),React.createElement("ul",{className:"mt-1 list-disc space-y-0.5 pl-4"},D.map((e,s)=>React.createElement("li",{key:s},e)))),React.createElement("div",{className:"space-y-4"},React.createElement("h3",{className:"text-xs font-semibold uppercase tracking-[0.24em] text-slate-500"},"Essentials"),React.createElement("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2"},React.createElement("label",{className:"block text-sm text-slate-600"},React.createElement("div",{className:"mb-1 flex items-center justify-between gap-2"},React.createElement("span",{className:"block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"Family"),React.createElement("button",{type:"button",onClick:la,className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-2.5 py-1 text-xs font-semibold text-slate-600 hover:bg-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"Manage")),React.createElement("select",{value:g,onChange:e=>{v([]),O(null),h(e.target.value)},className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner backdrop-blur focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},(u||[]).map(e=>React.createElement("option",{key:e.id,value:e.id},e.name)))),React.createElement("label",{className:"block text-sm text-slate-600"},React.createElement("div",{className:"mb-1 flex items-center justify-between gap-2"},React.createElement("span",{className:"block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"Category"),React.createElement("button",{type:"button",onClick:ia,className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-2.5 py-1 text-xs font-semibold text-slate-600 hover:bg-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"Manage")),React.createElement("select",{value:i,onChange:e=>{v([]),O(null),E(e.target.value)},className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner backdrop-blur focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},n.map(e=>React.createElement("option",{key:e,value:e},e)))),React.createElement("label",{className:"block text-sm text-slate-600"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"Price"),React.createElement("input",{type:"number",min:0,step:"0.01",value:_,onChange:e=>{v([]),O(null),B(e.target.value)},className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner backdrop-blur focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"})),React.createElement("label",{className:"block text-sm text-slate-600"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"Name"),React.createElement("input",{value:c,onChange:e=>{v([]),O(null),m(e.target.value)},className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner backdrop-blur focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"})),React.createElement("label",{className:"block text-sm text-slate-600"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"SKU"),React.createElement("input",{value:M,onChange:e=>{v([]),O(null),W(e.target.value)},className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner backdrop-blur focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"})),React.createElement("label",{className:"md:col-span-2 block text-sm text-slate-600"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"Short description"),React.createElement("textarea",{rows:3,value:G,onChange:e=>{v([]),O(null),H(e.target.value)},className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner backdrop-blur focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"})),React.createElement("label",{className:"block text-sm text-slate-600"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"Photos"),React.createElement("input",{type:"file",accept:"image/*",multiple:!0,onChange:bt}),$.length>0&&React.createElement("div",{className:"mt-2 flex flex-wrap gap-2"},$.map((e,s)=>React.createElement("div",{key:s,className:"relative"},React.createElement("img",{src:e,alt:`preview ${s+1}`,className:"h-20 w-20 overflow-hidden rounded-xl border border-[var(--surface-border)] object-cover"}),React.createElement("button",{type:"button",onClick:()=>{v([]),O(null),R(p=>p.filter((y,S)=>S!==s))},className:"absolute -right-1 -top-1 rounded-full border border-[var(--surface-border)] bg-white px-1 text-xs shadow","aria-label":`Remove photo ${s+1}`},"\xD7"))))))),React.createElement("div",{className:"space-y-3"},React.createElement("div",{className:"flex items-center justify-between"},React.createElement("h3",{className:"text-xs font-semibold uppercase tracking-[0.24em] text-slate-500"},"Product information"),React.createElement("button",{type:"button",onClick:()=>f("info"),className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-3 py-1.5 text-sm font-semibold text-slate-700 shadow-sm transition hover:bg-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"Add option group")),React.createElement("div",{className:"grid gap-3 md:grid-cols-2"},(fe.info||[]).map(e=>{const s=et(e);return React.createElement(dr,{key:e.id,label:e.label,mode:e.mode,fieldType:e.fieldType,options:kt(e),value:k[s],onChange:p=>xe(s,p),onEdit:()=>N("info",e),onRemove:()=>Xe("info",e)})}))),React.createElement("div",{className:"space-y-3"},React.createElement("div",{className:"flex items-center justify-between"},React.createElement("h3",{className:"text-xs font-semibold uppercase tracking-[0.24em] text-slate-500"},"Customer options"),React.createElement("button",{type:"button",onClick:()=>f("customer"),className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-3 py-1.5 text-sm font-semibold text-slate-700 shadow-sm transition hover:bg-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"Add option group")),React.createElement("div",{className:"grid gap-3 md:grid-cols-2"},(fe.customer||[]).map(e=>{const s=et(e);return React.createElement(mr,{key:e.id,label:e.label,mode:e.mode,options:kt(e),value:k[s],onChange:p=>xe(s,p),onEdit:()=>N("customer",e),onRemove:()=>Xe("customer",e)})}))),React.createElement("div",{className:"space-y-3"},React.createElement("div",{className:"flex flex-wrap items-center justify-between gap-3"},React.createElement("h3",{className:"text-xs font-semibold uppercase tracking-[0.24em] text-slate-500"},"Variant prices (optional)"),React.createElement("label",{className:"inline-flex items-center gap-2 rounded-full border border-[var(--surface-border)] bg-white/70 px-3 py-1.5 text-xs font-semibold text-slate-700 shadow-sm backdrop-blur"},React.createElement("input",{type:"checkbox",checked:_e,onChange:e=>We(e.target.checked),className:"h-4 w-4 rounded border-[var(--surface-border)] text-brand focus:ring-brand"}),"Override prices")),React.createElement("p",{className:"text-sm text-slate-600"},"Optional. Leave blank to use the base price for a selection."),_e&&React.createElement("div",{className:"space-y-3 rounded-2xl border border-[var(--surface-border)] bg-white/70 p-4 text-sm text-slate-600 shadow-sm backdrop-blur"},React.createElement("div",{className:"flex flex-wrap items-center justify-between gap-2"},React.createElement("div",{className:"text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},`Base price: ${_?Be(Number(_)||0):"\u2014"}`),React.createElement("div",{className:"flex flex-wrap gap-2"},React.createElement("button",{type:"button",onClick:Ee,className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-3 py-2 text-sm font-semibold text-slate-700 shadow-sm transition hover:bg-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"Copy base to all"),React.createElement("button",{type:"button",onClick:Te,className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-3 py-2 text-sm font-semibold text-slate-700 shadow-sm transition hover:bg-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"Clear all"))),React.createElement("div",{className:"max-h-72 space-y-2 overflow-y-auto pr-1"},it.filter(({key:e})=>e!==X).map(({key:e,selection:s})=>{var p;return React.createElement("label",{key:e,className:"flex items-center justify-between gap-3 rounded-2xl border border-[var(--surface-border)] bg-white/80 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner"},React.createElement("span",{className:"flex-1 text-xs font-semibold text-slate-700"},Ne(s)),React.createElement("input",{type:"number",min:0,step:"0.01",inputMode:"decimal",value:(p=$e[e])!=null?p:"",onChange:y=>ve(S=>({...S,[e]:y.target.value})),placeholder:"Default",className:"w-32 rounded-2xl border border-[var(--surface-border)] bg-white/80 px-3 py-2 text-right text-sm text-slate-800 shadow-inner focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"}))})))),React.createElement("div",{className:"space-y-3"},React.createElement("div",{className:"flex flex-wrap items-center justify-between gap-3"},React.createElement("h3",{className:"text-xs font-semibold uppercase tracking-[0.24em] text-slate-500"},"Stock limits (optional)"),React.createElement("label",{className:"inline-flex items-center gap-2 rounded-full border border-[var(--surface-border)] bg-white/70 px-3 py-1.5 text-xs font-semibold text-slate-700 shadow-sm backdrop-blur"},React.createElement("input",{type:"checkbox",checked:P,onChange:e=>Q(e.target.checked),className:"h-4 w-4 rounded border-[var(--surface-border)] text-brand focus:ring-brand"}),"Limit stock")),React.createElement("p",{className:"text-sm text-slate-600"},"Optional. Leave blank to keep a variant unlimited."),P&&React.createElement("div",{className:"space-y-3 rounded-2xl border border-[var(--surface-border)] bg-white/70 p-4 text-sm text-slate-600 shadow-sm backdrop-blur"},React.createElement("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-end sm:justify-between"},React.createElement("label",{className:"block flex-1 text-sm text-slate-600"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"Default quantity"),React.createElement("input",{type:"number",min:0,step:"1",value:ie,onChange:e=>se(e.target.value),placeholder:"e.g. 10",className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/80 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"})),React.createElement("div",{className:"flex flex-wrap gap-2"},React.createElement("button",{type:"button",onClick:ne,className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-3 py-2 text-sm font-semibold text-slate-700 shadow-sm transition hover:bg-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"Apply to all"),React.createElement("button",{type:"button",onClick:oe,className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-3 py-2 text-sm font-semibold text-slate-700 shadow-sm transition hover:bg-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"Clear all"))),React.createElement("div",{className:"max-h-72 space-y-2 overflow-y-auto pr-1"},it.map(({key:e,selection:s})=>{var p;return React.createElement("label",{key:e,className:"flex items-center justify-between gap-3 rounded-2xl border border-[var(--surface-border)] bg-white/80 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner"},React.createElement("span",{className:"flex-1 text-xs font-semibold text-slate-700"},Ne(s)),React.createElement("input",{type:"number",min:0,step:"1",inputMode:"numeric",value:(p=me[e])!=null?p:"",onChange:y=>ue(S=>({...S,[e]:y.target.value})),placeholder:"Unlimited",className:"w-32 rounded-2xl border border-[var(--surface-border)] bg-white/80 px-3 py-2 text-right text-sm text-slate-800 shadow-inner focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"}))})))),React.createElement("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-end"},React.createElement("button",{type:"button",onClick:Ur,disabled:b,className:Z("inline-flex items-center justify-center rounded-full px-6 py-2 text-sm font-semibold text-white shadow-sm focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",b?"bg-brand/50 cursor-not-allowed opacity-70":"bg-brand hover:bg-brand-muted")},b?"Saving...":"Add Product"),React.createElement("button",{type:"button",onClick:()=>{var e;return(e=window.__setOwnerManage)==null?void 0:e.call(window,!0)},className:"inline-flex items-center justify-center rounded-full border border-[var(--surface-border)] bg-white/70 px-6 py-2 text-sm font-semibold text-slate-800 shadow-sm transition hover:bg-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"Manage catalogue")),React.createElement(ea,{open:(Ae==null?void 0:Ae.type)==="group",title:he.id?"Edit option group":"Add option group",onClose:()=>be(null),actions:React.createElement(React.Fragment,null,React.createElement("button",{type:"button",onClick:()=>be(null),className:"rounded-full border border-[var(--surface-border)] bg-white px-4 py-2 text-sm font-semibold text-slate-700"},"Cancel"),React.createElement("button",{type:"button",onClick:lt,className:"rounded-full bg-brand px-4 py-2 text-sm font-semibold text-white"},"Save"))},ra&&React.createElement("div",{className:"rounded-2xl border border-rose-200 bg-rose-50 px-4 py-3 text-sm text-rose-700"},ra),React.createElement("label",{className:"block text-sm text-slate-600"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"Group name"),React.createElement("input",{value:he.label,onChange:e=>Ve(s=>({...s,label:e.target.value})),className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"})),React.createElement("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2"},React.createElement("label",{className:"block text-sm text-slate-600"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"Selection"),React.createElement("select",{value:he.mode,onChange:e=>Ve(s=>({...s,mode:e.target.value})),className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},React.createElement("option",{value:"single"},"Single"),React.createElement("option",{value:"multi"},"Multi"))),React.createElement("label",{className:"block text-sm text-slate-600"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"Options source"),React.createElement("select",{value:he.optionsSource,onChange:e=>Ve(s=>({...s,optionsSource:e.target.value})),className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},React.createElement("option",{value:"static"},"Custom list"),he.scope==="customer"&&React.createElement("option",{value:"familyModels"},"Use family models")))),he.optionsSource!=="familyModels"&&React.createElement("label",{className:"block text-sm text-slate-600"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"Options (comma or new line)"),React.createElement("textarea",{rows:6,value:he.optionsText,onChange:e=>Ve(s=>({...s,optionsText:e.target.value})),className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",placeholder:"Option 1, Option 2, Option 3\\nOption 4"}))),React.createElement(ea,{open:(Ae==null?void 0:Ae.type)==="category",title:"Manage categories",onClose:()=>be(null),actions:React.createElement("button",{type:"button",onClick:()=>be(null),className:"rounded-full border border-[var(--surface-border)] bg-white px-4 py-2 text-sm font-semibold text-slate-700"},"Close")},React.createElement("div",{className:"space-y-3"},React.createElement("div",{className:"flex flex-wrap items-end gap-2"},React.createElement("label",{className:"flex-1 block text-sm text-slate-600"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"New category"),React.createElement("input",{value:Wt,onChange:e=>Je(e.target.value),placeholder:"e.g. Camera parts",className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"})),React.createElement("button",{type:"button",onClick:Dt,className:"rounded-full bg-brand px-4 py-2 text-sm font-semibold text-white"},"Add")),React.createElement("div",{className:"space-y-2"},(n||[]).map(e=>React.createElement("div",{key:e,className:"flex items-center justify-between gap-2 rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3 py-2 text-sm text-slate-700"},React.createElement("button",{type:"button",onClick:()=>{E(e),be(null)},className:Z("flex-1 text-left font-medium",e===i?"text-slate-900":"text-slate-700")},e),React.createElement("button",{type:"button",onClick:()=>$t(e),className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-2.5 py-1 text-xs font-semibold text-slate-600 hover:bg-white","aria-label":`Remove category ${e}`},"\xD7")))))),React.createElement(ea,{open:(Ae==null?void 0:Ae.type)==="family",title:"Manage families",onClose:()=>be(null),actions:React.createElement("button",{type:"button",onClick:()=>be(null),className:"rounded-full border border-[var(--surface-border)] bg-white px-4 py-2 text-sm font-semibold text-slate-700"},"Close")},React.createElement("div",{className:"space-y-3"},React.createElement("div",{className:"space-y-2"},React.createElement("p",{className:"text-sm text-slate-600"},"Families control which model list appears in the phone model picker."),React.createElement("div",{className:"space-y-2"},(u||[]).map(e=>React.createElement("div",{key:e.id,className:"flex items-center justify-between gap-2 rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3 py-2 text-sm text-slate-700"},React.createElement("button",{type:"button",onClick:()=>{h(e.id),be(null)},className:Z("flex-1 text-left font-medium",e.id===g?"text-slate-900":"text-slate-700")},e.name),React.createElement("button",{type:"button",onClick:()=>pt(e),className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-2.5 py-1 text-xs font-semibold text-slate-600 hover:bg-white"},"Edit"),React.createElement("button",{type:"button",onClick:()=>l(e),className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-2.5 py-1 text-xs font-semibold text-slate-600 hover:bg-white","aria-label":`Remove family ${e.name}`},"\xD7"))))),React.createElement("div",{className:"rounded-2xl border border-[var(--surface-border)] bg-white/70 p-3 shadow-sm"},React.createElement("div",{className:"flex items-center justify-between"},React.createElement("h4",{className:"text-sm font-semibold text-slate-900"},Ie.id?"Edit family":"Add family"),Ie.id&&React.createElement("button",{type:"button",onClick:()=>Ue({id:null,name:"",modelsText:""}),className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-2.5 py-1 text-xs font-semibold text-slate-600 hover:bg-white"},"New")),React.createElement("div",{className:"mt-3 space-y-3"},React.createElement("label",{className:"block text-sm text-slate-600"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"Family name"),React.createElement("input",{value:Ie.name,onChange:e=>Ue(s=>({...s,name:e.target.value})),placeholder:"e.g. Samsung S",className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"})),React.createElement("label",{className:"block text-sm text-slate-600"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"Models (one per line)"),React.createElement("textarea",{rows:6,value:Ie.modelsText,onChange:e=>Ue(s=>({...s,modelsText:e.target.value})),placeholder:"iPhone 11\\niPhone 12\\n...",className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"})),React.createElement("div",{className:"flex justify-end"},React.createElement("button",{type:"button",onClick:Ut,className:"rounded-full bg-brand px-4 py-2 text-sm font-semibold text-white"},Ie.id?"Save changes":"Add family"))))))))}function Fr({label:a,options:r,value:t,onChange:o}){const n=()=>o(r),u=()=>o([]),i=E=>o(t.includes(E)?t.filter(g=>g!==E):[...t,E]);return React.createElement("div",{className:"space-y-2 rounded-2xl border border-[var(--surface-border)] bg-white/70 p-4 text-sm text-slate-600 shadow-sm backdrop-blur"},React.createElement("div",{className:"flex items-center justify-between"},React.createElement("span",{className:"text-sm font-semibold text-slate-800"},a),React.createElement("div",{className:"flex items-center gap-2 text-xs"},React.createElement("button",{type:"button",onClick:n,className:"rounded-full border border-[var(--surface-border)] px-2 py-0.5 font-medium text-slate-600 hover:bg-white/60"},"All"),React.createElement("button",{type:"button",onClick:u,className:"rounded-full border border-[var(--surface-border)] px-2 py-0.5 font-medium text-slate-600 hover:bg-white/60"},"Clear"))),React.createElement("div",{className:"flex flex-wrap gap-1.5 text-xs"},r.map(E=>{const g=t.includes(E),h=/color/i.test(a)||_t[E]!==void 0;return React.createElement("button",{type:"button",key:E,onClick:()=>i(E),className:Z("rounded-full border px-2 py-1 text-xs",g?"border-transparent bg-brand text-white":"border-[var(--surface-border)] bg-white text-slate-700")},h?React.createElement(React.Fragment,null,React.createElement(st,{name:E})," ",E):E)})))}function Wr({open:a,onClose:r,product:t,catalogConfig:o,onSave:n,onHide:u,onDelete:i}){var $t,pt,Ut;const E=le(null);jt(!!a,E,r);const g=()=>Math.random().toString(36).slice(2,10),h=l=>Ka(l).map(N=>{const C=String(N||"").trim(),I=C.indexOf(":");if(I>0){const q=C.slice(0,I).trim(),Le=C.slice(I+1).trim();if(q&&Le)return{id:g(),label:q,value:Le}}return{id:g(),label:C,value:""}}).filter(N=>N.label),d=l=>String(l||"").split(/[\n,]/g).map(f=>String(f).trim()).filter(Boolean),x=l=>{if(!l||typeof l!="object"||Array.isArray(l))return{};const f={};return Object.entries(l).forEach(([N,C])=>{const I=String(N||"").trim();if(!I||I===X)return;const q=Number(C);Number.isFinite(q)&&q>=0&&(f[I]=q)}),f},[c,m]=w((t==null?void 0:t.name)||""),[M,W]=w((t==null?void 0:t.sku)||""),[_,B]=w((t==null?void 0:t.category)||"All"),[G,H]=w(va(t)||""),[$,R]=w(String(($t=t==null?void 0:t.price)!=null?$t:0)),[D,v]=w((t==null?void 0:t.description)||""),[z,O]=w(()=>h(t==null?void 0:t.specs)),[b,A]=w(()=>[...Array.isArray(t==null?void 0:t.images)&&t.images.length?t.images:t!=null&&t.image?[t.image]:[]]),[k,j]=w(0),[P,Q]=w(()=>{const l={...(t==null?void 0:t.variants)||{}};return l.Color&&!Array.isArray(l.Color)&&(l.Color=[l.Color]),l.Model&&!Array.isArray(l.Model)&&(l.Model=[l.Model]),l}),[ie,se]=w({}),[me,ue]=w(!1),[_e,We]=w(""),[$e,ve]=w(""),[ke,Me]=w(()=>Object.keys(ze(t==null?void 0:t.inventory)).length>0),[ut,qe]=w(()=>{const l=ze(t==null?void 0:t.inventory),f={};return Object.entries(l).forEach(([N,C])=>{f[String(N)]=String(Math.floor(Number(C)||0))}),f}),[F,ee]=w(""),[te,we]=w(()=>{var l;return Object.keys(x((l=t==null?void 0:t.variants)==null?void 0:l[He])).length>0}),[ot,xe]=w(()=>{var N;const l=x((N=t==null?void 0:t.variants)==null?void 0:N[He]),f={};return Object.entries(l).forEach(([C,I])=>{f[String(C)]=String(I)}),f});T(()=>{var I,q;if(!a)return;m((t==null?void 0:t.name)||""),W((t==null?void 0:t.sku)||""),B((t==null?void 0:t.category)||"All"),H(va(t)||""),R(String((I=t==null?void 0:t.price)!=null?I:0)),v((t==null?void 0:t.description)||""),O(h(t==null?void 0:t.specs));const l=Array.isArray(t==null?void 0:t.images)&&t.images.length?t.images:t!=null&&t.image?[t.image]:[];A([...l]),j(0);const f={...(t==null?void 0:t.variants)||{}};f.Color&&!Array.isArray(f.Color)&&(f.Color=[f.Color]),f.Model&&!Array.isArray(f.Model)&&(f.Model=[f.Model]),Q(f),se({}),ue(!1),We(""),ve("");const N=ze(t==null?void 0:t.inventory);Me(Object.keys(N).length>0),qe(()=>{const Le={};return Object.entries(N).forEach(([Xe,lt])=>{Le[String(Xe)]=String(Math.floor(Number(lt)||0))}),Le}),ee("");const C=x((q=t==null?void 0:t.variants)==null?void 0:q[He]);we(Object.keys(C).length>0),xe(()=>{const Le={};return Object.entries(C).forEach(([Xe,lt])=>{Le[String(Xe)]=String(lt)}),Le})},[a,t==null?void 0:t.id]);const Ye=l=>{const f=Array.from(l.target.files||[]);if(!f.length)return;const N=f.map(C=>new Promise(I=>{const q=new FileReader;q.onload=()=>I(String(q.result||"")),q.readAsDataURL(C)}));Promise.all(N).then(C=>A(I=>[...I,...C]))},bt=()=>j(l=>(l-1+b.length)%b.length),je=()=>j(l=>(l+1)%b.length),Nt=J(()=>{const l=Array.isArray(o==null?void 0:o.families)?o.families.map(C=>String((C==null?void 0:C.name)||"").trim()).filter(Boolean):[],f=l.length?l:["iPhone","Samsung S","Samsung A","Accessories"],N=String(G||"").trim();return N&&!f.includes(N)?[...f,N]:f},[o,G]),Lt=J(()=>{const l=Array.isArray(o==null?void 0:o.categories)?o.categories.filter(Boolean):[],f=l.length?l:At.filter(I=>I!=="All"),N=String(_||"").trim(),C=["All",...f];return N&&N!=="All"&&!f.includes(N)?[...C,N]:C},[o,_]),Tt=J(()=>{const l=String(G||"").trim(),N=(Array.isArray(o==null?void 0:o.families)?o.families:[]).find(q=>String((q==null?void 0:q.name)||"").trim()===l),C=Array.isArray(N==null?void 0:N.models)?N.models.map(q=>String(q).trim()).filter(Boolean):[];if(C.length)return C;const I=l.toLowerCase();return I.includes("iphone")?rt:I.includes("samsung s")?Ct:I.includes("samsung a")?Ot:[...rt,...Ct,...Ot]},[o,G]),fe=J(()=>{const l={};return Object.entries(P||{}).forEach(([f,N])=>{!f||String(f).startsWith("__")||!Array.isArray(N)||N.length===0||(l[f]=N)}),l},[P]),Rt=J(()=>{const l=Object.keys(fe),f=["Model","Color"];return l.sort((N,C)=>{const I=f.indexOf(N),q=f.indexOf(C);return I!==-1||q!==-1?(I===-1?99:I)-(q===-1?99:q):N.localeCompare(C)}),l},[fe]),Se=J(()=>ba(fe),[fe]),Ae=J(()=>new Set(Se.map(({key:l})=>l)),[Se]),be=l=>{const f=Object.entries(l||{}).filter(([N,C])=>C!=null&&String(C).trim()!=="").sort(([N],[C])=>N.localeCompare(C));return f.length?f.map(([N,C])=>`${N}: ${C}`).join(" \u2022 "):"Base product"},he=Array.from(new Set([...Array.isArray(P.Model)?P.Model:[]])),Ve=Array.from(new Set([...Array.isArray(P.Color)?P.Color:[]])),ra=l=>{A(f=>{if(l<=0||l>=f.length)return f;const N=[...f],[C]=N.splice(l,1);return N.unshift(C),N}),j(0)},Qe=l=>{A(f=>f.filter((N,C)=>C!==l)),j(f=>f===l?0:f>l?f-1:f)},sa=(l,f,N)=>{O(C=>C.map(I=>I.id===l?{...I,[f]:N}:I))},Ft=()=>O(l=>[...l,{id:g(),label:"",value:""}]),Wt=l=>O(f=>f.filter(N=>N.id!==l)),Je=(l,f)=>{const N=String(l||"").trim();if(!N||N.startsWith("__"))return;const C=Array.from(new Set((Array.isArray(f)?f:[]).map(I=>String(I).trim()).filter(Boolean)));Q(I=>{const q={...I||{}};return C.length?q[N]=C:delete q[N],q})},Ie=l=>{const f=String(l||"").trim();f&&(Q(N=>{const C={...N||{}};return delete C[f],C}),se(N=>{const C={...N||{}};return delete C[f],C}))},Ue=l=>{const f=String(l||"").trim();if(!f)return;const N=d(ie[f]||"");if(!N.length)return;const C=Array.isArray(P==null?void 0:P[f])?P[f]:[];Je(f,[...C,...N]),se(I=>({...I||{},[f]:""}))},na=()=>{const l=String(_e||"").trim();if(!l||l.startsWith("__"))return;const f=d($e);f.length&&(Je(l,f),We(""),ve(""),ue(!1))},oa=()=>{const l=String(F||"").trim();if(!l)return;const f=Number(l);if(!Number.isFinite(f)||f<0)return;const N=String(Math.floor(f));qe(C=>{const I={...C||{}};return Se.forEach(({key:q})=>{I[q]=N}),I})},Ze=()=>{qe(l=>{const f={...l||{}};return Se.forEach(({key:N})=>{f[N]=""}),f})},la=()=>{xe(l=>{const f={...l||{}};return Se.forEach(({key:N})=>{N!==X&&(f[N]="")}),f})},ia=()=>{const l=c.trim()||t.name,f=M.trim()||t.sku,N=Number($),C=Number.isFinite(N)&&N>=0?N:Number(t.price)||0,I=String(_||t.category||"").trim()||"All",q=String(G||"").trim(),Le=(Array.isArray(t==null?void 0:t.specs)?t.specs:[]).filter(ne=>{const oe=String(ne||"");return oe&&oe.startsWith(ha)&&!oe.startsWith(vt)}).map(ne=>String(ne)),Xe=z.map(ne=>{const oe=String((ne==null?void 0:ne.label)||"").trim();if(!oe)return null;const Ee=String((ne==null?void 0:ne.value)||"").trim();return Ee?`${oe}: ${Ee}`:oe}).filter(Boolean),lt=Array.from(new Set([...q?[`${vt}${q}`]:[],...Le,...Xe])),ca={};t!=null&&t.variants&&typeof t.variants=="object"&&!Array.isArray(t.variants)&&Object.entries(t.variants).forEach(([ne,oe])=>{!ne||ne===He||Array.isArray(oe)||String(ne).startsWith("__")&&(ca[ne]=oe)});const et={};Object.entries(fe||{}).forEach(([ne,oe])=>{const Ee=String(ne||"").trim();if(!Ee)return;const Te=Array.from(new Set((Array.isArray(oe)?oe:[]).map(Ne=>String(Ne).trim()).filter(Boolean)));Te.length&&(et[Ee]=Te)});const kt={...ca,...et};if(te){const ne=C,oe={};Object.entries(ot||{}).forEach(([Ee,Te])=>{const Ne=String(Ee||"").trim();if(!Ne||Ne===X||!Ae.has(Ne))return;const Gt=String(Te!=null?Te:"").trim();if(!Gt)return;const yt=Number(Gt);!Number.isFinite(yt)||yt<0||Math.abs(yt-ne)<1e-9||(oe[Ne]=yt)}),Object.keys(oe).length&&(kt[He]=oe)}const ft={};ke&&Object.entries(ut||{}).forEach(([ne,oe])=>{const Ee=String(ne||"").trim();if(!Ee||!Ae.has(Ee))return;const Te=String(oe!=null?oe:"").trim();if(!Te)return;const Ne=Number(Te);!Number.isFinite(Ne)||Ne<0||(ft[Ee]=Math.floor(Ne))});const it=Array.from(new Set((b||[]).map(ne=>String(ne||"")).filter(Boolean))),Ce=ye({...t||{},name:l,sku:f,category:I,price:C,description:D,images:it,image:it[0]||void 0,specs:lt,variants:kt,inventory:ft});n(Ce,t==null?void 0:t.id),r()},Dt=!!((Ut=(pt=t==null?void 0:t.id)==null?void 0:pt.startsWith)!=null&&Ut.call(pt,"owner-"));return!a||!t?null:React.createElement("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 p-0 sm:p-6",role:"dialog","aria-modal":"true"},React.createElement("div",{ref:E,className:"w-full sm:max-w-3xl rounded-3xl border border-[var(--surface-border)] bg-[rgba(255,255,255,0.96)] backdrop-blur-xl shadow-soft-xl outline-none max-h-[90vh] overflow-y-auto"},React.createElement("div",{className:"flex items-center justify-between border-b border-[var(--surface-border)] bg-white/70 px-5 py-4"},React.createElement("h3",{className:"text-lg font-semibold text-slate-900"},"Edit product"),React.createElement("div",{className:"flex items-center gap-2"},!Dt&&React.createElement("button",{onClick:()=>{u(t.id),r()},className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-3.5 py-1.5 text-sm font-semibold text-slate-700 transition hover:bg-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"Hide base"),Dt&&React.createElement("button",{onClick:()=>{i(t.id),r()},className:"rounded-full border border-rose-300 bg-rose-50/80 px-3.5 py-1.5 text-sm font-semibold text-rose-700 transition hover:bg-rose-100 focus:outline-none focus-visible:outline-2 focus-visible:outline-rose-400"},"Delete"),React.createElement("button",{onClick:r,className:"rounded-full px-3.5 py-1.5 text-sm font-semibold text-slate-500 transition hover:bg-white/70 focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"Close"))),React.createElement("div",{className:"grid gap-4 p-4 sm:grid-cols-2"},React.createElement("div",{className:"flex flex-col gap-2"},React.createElement("div",{className:"relative aspect-square w-full overflow-hidden rounded-xl bg-slate-100"},React.createElement("img",{src:Et(b[k]||"",t.name),onError:l=>{l.currentTarget.src=nt(t.name)},alt:`${t.name} \u2013 photo ${k+1} of ${b.length}`,className:"h-full w-full object-cover"}),b.length>1&&React.createElement(React.Fragment,null,React.createElement("button",{type:"button",onClick:bt,className:"absolute left-2 top-1/2 -translate-y-1/2 rounded-full bg-white/90 p-2 shadow focus:outline-none focus-visible:outline-2 focus-visible:outline-brand","aria-label":"Previous photo"},"\u2039"),React.createElement("button",{type:"button",onClick:je,className:"absolute right-2 top-1/2 -translate-y-1/2 rounded-full bg-white/90 p-2 shadow focus:outline-none focus-visible:outline-2 focus-visible:outline-brand","aria-label":"Next photo"},"\u203A"))),React.createElement("div",{className:"flex items-center gap-2"},React.createElement("label",{className:"text-xs text-slate-700 inline-flex items-center gap-2"},React.createElement("span",{className:"rounded-full border border-[var(--surface-border)] bg-white px-2 py-1"},"Add photos"),React.createElement("input",{type:"file",accept:"image/*",multiple:!0,onChange:Ye,className:"sr-only"}))),b.length>0&&React.createElement("div",{className:"flex gap-2 overflow-x-auto"},b.map((l,f)=>React.createElement("div",{key:f,className:Z("relative h-14 w-20 flex-shrink-0 overflow-hidden rounded-md border",f===k?"border-brand":"border-[var(--surface-border)]")},React.createElement("button",{type:"button",onClick:()=>j(f),className:"absolute inset-0"},React.createElement("img",{src:Et(l,t.name),alt:"",className:"h-full w-full object-cover"})),React.createElement("button",{type:"button",onClick:()=>Qe(f),className:"absolute -right-1 -top-1 rounded-full bg-white border p-0.5 shadow","aria-label":`Remove photo ${f+1}`},"\xD7"))))),React.createElement("div",{className:"flex min-w-0 flex-col gap-3"},React.createElement("div",{className:"grid gap-3 sm:grid-cols-2"},React.createElement("label",{className:"block text-sm"},React.createElement("span",{className:"mb-1 block text-slate-700"},"Family"),React.createElement("select",{value:G,onChange:l=>H(l.target.value),className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner backdrop-blur focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},React.createElement("option",{value:""},"(none)"),Nt.map(l=>React.createElement("option",{key:l,value:l},l)))),React.createElement("label",{className:"block text-sm"},React.createElement("span",{className:"mb-1 block text-slate-700"},"Category"),React.createElement("select",{value:_,onChange:l=>B(l.target.value),className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner backdrop-blur focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},Lt.map(l=>React.createElement("option",{key:l,value:l},l))))),React.createElement("label",{className:"block text-sm"},React.createElement("span",{className:"mb-1 block text-slate-700"},"Name"),React.createElement("input",{value:c,onChange:l=>m(l.target.value),className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner backdrop-blur focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"})),React.createElement("label",{className:"block text-sm"},React.createElement("span",{className:"mb-1 block text-slate-700"},"SKU"),React.createElement("input",{value:M,onChange:l=>W(l.target.value),className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner backdrop-blur focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"})),React.createElement("label",{className:"block text-sm"},React.createElement("span",{className:"mb-1 block text-slate-700"},"Base price"),React.createElement("input",{type:"number",min:0,step:"0.01",value:$,onChange:l=>R(l.target.value),className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner backdrop-blur focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"})),React.createElement("label",{className:"block text-sm"},React.createElement("span",{className:"mb-1 block text-slate-700"},"Description"),React.createElement("textarea",{rows:3,value:D,onChange:l=>v(l.target.value),className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner backdrop-blur focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"})),React.createElement("div",{className:"rounded-2xl border border-[var(--surface-border)] bg-white/70 p-3"},React.createElement("div",{className:"flex items-center justify-between"},React.createElement("span",{className:"text-sm font-semibold text-slate-800"},"Product information"),React.createElement("button",{type:"button",onClick:Ft,className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-2.5 py-1 text-xs font-semibold text-slate-600 hover:bg-white"},"Add")),React.createElement("div",{className:"mt-2 space-y-2"},z.map(l=>React.createElement("div",{key:l.id,className:"grid gap-2 sm:grid-cols-[minmax(0,1fr)_minmax(0,1fr)_auto] items-center"},React.createElement("input",{value:l.label,onChange:f=>sa(l.id,"label",f.target.value),placeholder:"Label",className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white px-3 py-2 text-sm text-slate-800 shadow-inner focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"}),React.createElement("input",{value:l.value,onChange:f=>sa(l.id,"value",f.target.value),placeholder:"Value (optional)",className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white px-3 py-2 text-sm text-slate-800 shadow-inner focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"}),React.createElement("button",{type:"button",onClick:()=>Wt(l.id),className:"rounded-full border border-[var(--surface-border)] bg-white px-3 py-2 text-sm font-semibold text-slate-700 hover:bg-white/70","aria-label":"Remove row"},"\xD7"))),z.length===0&&React.createElement("p",{className:"text-xs text-slate-500"},"No product information yet."))),React.createElement("div",{className:"rounded-2xl border border-[var(--surface-border)] bg-white/70 p-3"},React.createElement("div",{className:"flex items-center justify-between"},React.createElement("span",{className:"text-sm font-semibold text-slate-800"},"Customer options"),React.createElement("button",{type:"button",onClick:()=>ue(l=>!l),className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-2.5 py-1 text-xs font-semibold text-slate-600 hover:bg-white"},"Add option group")),me&&React.createElement("div",{className:"mt-3 rounded-2xl border border-[var(--surface-border)] bg-white/80 p-3"},React.createElement("div",{className:"grid gap-2 sm:grid-cols-2"},React.createElement("label",{className:"block text-sm"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"Group name"),React.createElement("input",{value:_e,onChange:l=>We(l.target.value),placeholder:"e.g. RAM",className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white px-3 py-2 text-sm text-slate-800 shadow-inner focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"})),React.createElement("label",{className:"block text-sm"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"Options"),React.createElement("textarea",{rows:2,value:$e,onChange:l=>ve(l.target.value),placeholder:"One per line or comma-separated",className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white px-3 py-2 text-sm text-slate-800 shadow-inner focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"}))),React.createElement("div",{className:"mt-2 flex justify-end gap-2"},React.createElement("button",{type:"button",onClick:()=>{ue(!1),We(""),ve("")},className:"rounded-full border border-[var(--surface-border)] bg-white px-3 py-1.5 text-sm font-semibold text-slate-700 hover:bg-white/70"},"Cancel"),React.createElement("button",{type:"button",onClick:na,className:"rounded-full bg-brand px-3 py-1.5 text-sm font-semibold text-white hover:bg-brand-muted"},"Add group"))),React.createElement("div",{className:"mt-3 grid gap-3"},Rt.length===0&&React.createElement("p",{className:"text-xs text-slate-500"},"No customer option groups yet."),Rt.map(l=>{const f=Array.isArray(P==null?void 0:P[l])?P[l]:[],N=ie[l]||"",C=l==="Model"?Array.from(new Set([...Tt||[],...f])):l==="Color"?Array.from(new Set([...wt||[],...f])):f;return React.createElement("div",{key:l,className:"space-y-2 rounded-2xl border border-[var(--surface-border)] bg-white/80 p-3"},React.createElement("div",{className:"flex items-center justify-between gap-2"},React.createElement("span",{className:"text-sm font-semibold text-slate-800"},l),React.createElement("button",{type:"button",onClick:()=>Ie(l),className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-2.5 py-1 text-xs font-semibold text-slate-600 hover:bg-white","aria-label":`Remove ${l}`},"\xD7")),l==="Model"||l==="Color"?React.createElement(Fr,{label:l==="Model"?"Models":"Colors",options:C,value:f,onChange:I=>Je(l,I)}):React.createElement("div",{className:"flex flex-wrap gap-1.5 text-xs"},f.map(I=>React.createElement("span",{key:I,className:"inline-flex items-center gap-1 rounded-full border border-[var(--surface-border)] bg-white px-2.5 py-1 text-xs font-medium text-slate-600"},I,React.createElement("button",{type:"button",onClick:()=>Je(l,f.filter(q=>q!==I)),className:"text-slate-500 hover:text-slate-800","aria-label":`Remove ${I}`},"\xD7"))),f.length===0&&React.createElement("span",{className:"text-xs text-slate-500"},"No options yet.")),React.createElement("div",{className:"flex gap-2"},React.createElement("input",{value:N,onChange:I=>se(q=>({...q||{},[l]:I.target.value})),onKeyDown:I=>{I.key==="Enter"&&(I.preventDefault(),Ue(l))},placeholder:"Add options (comma or newline)",className:"flex-1 rounded-2xl border border-[var(--surface-border)] bg-white px-3 py-2 text-sm text-slate-800 shadow-inner focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"}),React.createElement("button",{type:"button",onClick:()=>Ue(l),className:"rounded-full border border-[var(--surface-border)] bg-white px-3 py-2 text-sm font-semibold text-slate-700 hover:bg-white/70"},"Add")))}))),React.createElement("div",{className:"rounded-2xl border border-[var(--surface-border)] bg-white/70 p-3"},React.createElement("div",{className:"flex items-center justify-between gap-2"},React.createElement("span",{className:"text-sm font-semibold text-slate-800"},"Stock limits (optional)"),React.createElement("label",{className:"inline-flex items-center gap-2 text-xs font-semibold text-slate-600"},React.createElement("input",{type:"checkbox",checked:ke,onChange:l=>Me(l.target.checked)}),"Limit stock")),ke&&React.createElement("div",{className:"mt-2 space-y-2"},React.createElement("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between"},React.createElement("input",{value:F,onChange:l=>ee(l.target.value),inputMode:"numeric",placeholder:"Default (optional)",className:"w-full sm:w-44 rounded-2xl border border-[var(--surface-border)] bg-white px-3 py-2 text-sm text-slate-800 shadow-inner focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"}),React.createElement("div",{className:"flex gap-2"},React.createElement("button",{type:"button",onClick:oa,className:"rounded-full border border-[var(--surface-border)] bg-white px-3 py-2 text-sm font-semibold text-slate-700 hover:bg-white/70"},"Apply to all"),React.createElement("button",{type:"button",onClick:Ze,className:"rounded-full border border-[var(--surface-border)] bg-white px-3 py-2 text-sm font-semibold text-slate-700 hover:bg-white/70"},"Clear"))),React.createElement("div",{className:"max-h-56 overflow-y-auto rounded-2xl border border-[var(--surface-border)] bg-white/80 p-3 space-y-2"},Se.map(({key:l,selection:f})=>{var N;return React.createElement("div",{key:l,className:"flex items-center justify-between gap-3"},React.createElement("span",{className:"text-xs text-slate-600"},be(f)),React.createElement("input",{value:(N=ut[l])!=null?N:"",onChange:C=>qe(I=>({...I||{},[l]:C.target.value})),inputMode:"numeric",placeholder:"\u221E",className:"w-24 rounded-2xl border border-[var(--surface-border)] bg-white px-3 py-1.5 text-sm text-slate-800 shadow-inner focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"}))})),React.createElement("p",{className:"text-xs text-slate-500"},"Leave blank for unlimited stock."))),React.createElement("div",{className:"rounded-2xl border border-[var(--surface-border)] bg-white/70 p-3"},React.createElement("div",{className:"flex items-center justify-between gap-2"},React.createElement("span",{className:"text-sm font-semibold text-slate-800"},"Variant prices (optional)"),React.createElement("label",{className:"inline-flex items-center gap-2 text-xs font-semibold text-slate-600"},React.createElement("input",{type:"checkbox",checked:te,onChange:l=>we(l.target.checked)}),"Override prices")),te&&React.createElement("div",{className:"mt-2 space-y-2"},React.createElement("div",{className:"flex justify-end"},React.createElement("button",{type:"button",onClick:la,className:"rounded-full border border-[var(--surface-border)] bg-white px-3 py-2 text-sm font-semibold text-slate-700 hover:bg-white/70"},"Clear overrides")),React.createElement("div",{className:"max-h-56 overflow-y-auto rounded-2xl border border-[var(--surface-border)] bg-white/80 p-3 space-y-2"},Se.map(({key:l,selection:f})=>{var N;return l===X?null:React.createElement("div",{key:l,className:"flex items-center justify-between gap-3"},React.createElement("span",{className:"text-xs text-slate-600"},be(f)),React.createElement("input",{value:(N=ot[l])!=null?N:"",onChange:C=>xe(I=>({...I||{},[l]:C.target.value})),inputMode:"decimal",placeholder:String(Number($)||0),className:"w-24 rounded-2xl border border-[var(--surface-border)] bg-white px-3 py-1.5 text-sm text-slate-800 shadow-inner focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"}))})),React.createElement("p",{className:"text-xs text-slate-500"},"Leave blank to use the base price."))),React.createElement("div",{className:"mt-2 flex justify-end gap-3"},React.createElement("button",{onClick:r,className:"rounded-full border border-[var(--surface-border)] bg-white px-4 py-2 text-sm text-slate-900 hover:bg-white/70"},"Cancel"),React.createElement("button",{onClick:ia,className:"rounded-full bg-brand px-4 py-2 text-sm font-semibold text-white transition hover:bg-brand-muted"},"Save changes"))))))}function Dr({products:a,catalogConfig:r,onClose:t,onEdit:o,onHide:n,onDelete:u,onSave:i}){const[E,g]=w(""),[h,d]=w(null),x=J(()=>{let c=a;if(E){const m=E.toLowerCase();c=c.filter(M=>M.name.toLowerCase().includes(m)||M.sku.toLowerCase().includes(m)||(M.description||"").toLowerCase().includes(m))}return c},[a,E]);return React.createElement("section",{"aria-labelledby":"mgr-title",className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-6"},React.createElement("div",{className:"space-y-6 rounded-3xl border border-[var(--surface-border)] bg-white/95 p-6 shadow-soft-xl sm:p-8"},React.createElement("div",{className:"sticky top-[calc(var(--header-offset,64px)+12px)] z-10 rounded-2xl border border-[var(--surface-border)] bg-white/90 px-4 py-3 shadow-sm backdrop-blur"},React.createElement("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between"},React.createElement("h2",{id:"mgr-title",className:"text-base sm:text-lg font-semibold text-slate-900"},"Owner \u2014 Manage catalogue"),React.createElement("div",{className:"flex items-center gap-2"},React.createElement("label",{className:"relative flex-1 sm:w-auto"},React.createElement("span",{className:"sr-only"},"Search"),React.createElement("input",{value:E,onChange:c=>g(c.target.value),placeholder:"Search\u2026",type:"search",className:"w-full rounded-full border border-[var(--surface-border)] bg-white px-3.5 py-2 text-sm font-medium text-slate-600 shadow-inner placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-brand focus:border-transparent"}),React.createElement(ta,{className:"pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"})),React.createElement("button",{onClick:t,className:"rounded-full border border-[var(--surface-border)] bg-white px-3.5 py-2 text-sm font-semibold text-slate-700 shadow-sm transition hover:bg-white/90 focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"Back")))),React.createElement("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3"},(x||[]).map(c=>React.createElement("article",{key:c.id,className:"group flex flex-col overflow-hidden rounded-3xl border border-[var(--surface-border)] bg-white transition hover:-translate-y-0.5 hover:shadow-soft-xl"},React.createElement("div",{className:"aspect-square w-full bg-slate-100"},React.createElement("img",{src:Et(Array.isArray(c.images)&&c.images[0]||c.image||"",c.name),onError:m=>{m.currentTarget.src=nt(c.name)},alt:c.name,className:"h-full w-full object-cover"})),React.createElement("div",{className:"flex flex-1 flex-col gap-3 p-4"},React.createElement("header",null,React.createElement("h3",{className:"text-base font-semibold text-slate-900"},c.name),React.createElement("p",{className:"mt-0.5 text-xs text-slate-500"},"SKU: ",c.sku)),React.createElement("div",{className:"flex flex-wrap gap-1.5"},(c.specs||[]).slice(0,4).map(m=>React.createElement("span",{key:m,className:"inline-flex items-center rounded-full border border-[var(--surface-border)] bg-white/80 px-2.5 py-0.5 text-xs font-medium text-slate-600"},m))),React.createElement("div",{className:"mt-auto flex items-center justify-between"},React.createElement("span",{className:"font-semibold text-slate-900"},Be(c.price)),c.minOrder&&React.createElement("span",{className:"text-xs text-slate-500"},"MOQ ",c.minOrder)),React.createElement("div",{className:"flex gap-2"},React.createElement("button",{onClick:()=>d(c),className:"flex-1 rounded-full bg-brand px-4 py-2 text-sm font-semibold text-white shadow-sm transition hover:bg-brand-muted"},"Edit"),c.id.startsWith("owner-")?React.createElement("button",{onClick:()=>u(c.id),className:"rounded-full border border-red-300 bg-white px-3 py-2 text-sm text-red-700 hover:bg-red-50"},"Delete"):React.createElement("button",{onClick:()=>n(c.id),className:"rounded-full border border-[var(--surface-border)] bg-white px-3.5 py-2 text-sm font-semibold text-slate-700 transition hover:bg-white/90"},"Hide"))))))),React.createElement(Wr,{open:!!h,onClose:()=>d(null),product:h,catalogConfig:r,onSave:i,onHide:n,onDelete:u}))}function $r(){const a=React.useRef(0),[r,t]=w(""),[o,n]=w("All"),[u,i]=w(null),[E,g]=w(!1),[h,d]=w("dashboard"),[x,c]=w(qt&&ct),m=at?!0:ct?x:!1,M=ur(),W=Ke?c:()=>{};T(()=>{m||d("dashboard")},[m]);const[_,B]=w(null),G=le(null),H=(F,ee)=>{ee&&(B({type:F,message:ee}),G.current&&clearTimeout(G.current),G.current=setTimeout(()=>B(null),4e3))};T(()=>()=>{G.current&&clearTimeout(G.current)},[]);const{ownerProducts:$,setOwnerProducts:R,addProduct:D,deleteProduct:v,loading:z,connectionStatus:O}=pr(),{catalogConfig:b,saveCatalogConfig:A}=br($,R),{orders:k,loadingOrders:j,ordersError:P,ordersMeta:Q,refreshOrders:ie,updateOrderStatus:se}=fr();cr(!!(u||E),a);const ue=J(()=>{const F=new Map(or.map(te=>[te.id,te])),ee=[];return $.forEach(te=>{if(!(te&&te.id===Pt)){if(te.sourceId&&F.has(te.sourceId)){if(te.hidden){F.delete(te.sourceId);return}F.delete(te.sourceId)}te.hidden||(te.sourceId?F.set(te.id,te):ee.push(te))}}),[...ee,...Array.from(F.values())]},[$]),_e=J(()=>{let F=ue;return o!=="All"&&(F=F.filter(ee=>ee.category===o)),r&&(F=F.filter(ee=>ee.name.toLowerCase().includes(r.toLowerCase())||ee.sku.toLowerCase().includes(r.toLowerCase())||(ee.description||"").toLowerCase().includes(r.toLowerCase()))),F},[ue,o,r]);T(()=>(window.__setOwnerManage=F=>{d(F?"manage":"dashboard")},()=>{window.__setOwnerManage=void 0}),[]);const We=F=>R(ee=>{const te=ee.findIndex(we=>we.id===F.id);if(te>=0){const we=[...ee];return we[te]=F,we}return[...ee,F]}),$e=async(F,ee)=>{var Ye,bt;const te=(bt=(Ye=F.id)==null?void 0:Ye.startsWith)==null?void 0:bt.call(Ye,"owner-"),we=ye(te?F:{...F,id:`owner-${Date.now()}`,sourceId:ee}),ot=await Qt(we);We(ot||we),ot?H("success","Product updated."):H("warning","Product updated locally. Supabase sync pending.")},ve=async F=>{const ee=ye({id:`owner-hide-${Date.now()}`,sourceId:F,hidden:!0,name:"",sku:"",category:"All",price:0,description:"",specs:[]}),te=await Qt(ee);We(te||ee),te?H("success","Base product hidden."):H("warning","Base product hidden locally. Supabase sync pending.")},ke=async F=>{const ee=await v(F);return ee?H("success","Product deleted."):H("error","Could not delete product. Check your connection and try again."),ee},Me=J(()=>React.createElement(Rr,{allProducts:ue,ownerProducts:$,orders:k,loadingOrders:j,ordersMeta:Q,ordersError:P,onNavigate:d,refreshOrders:ie}),[ue,$,k,j,Q,P,ie]),ut=J(()=>[{id:"dashboard",label:"Dashboard",description:"Key metrics & recents",icon:vr,element:Me},{id:"add",label:"Add product",description:"Create new catalogue items",icon:wr,element:React.createElement(Tr,{addProduct:D,onNotify:H,onNavigate:d,catalogConfig:b,saveCatalogConfig:A})},{id:"manage",label:"Manage catalogue",description:"Edit overrides & hide base items",icon:Er,element:React.createElement(Dr,{products:ue,catalogConfig:b,onClose:()=>d("add"),onEdit:F=>i({__edit:!0,product:F}),onHide:F=>ve(F),onDelete:F=>ke(F),onSave:$e})},{id:"orders",label:"Orders",description:"Track open, confirmed & shipped",icon:Nr,element:React.createElement(kr,{orders:k,loading:j,error:P,meta:Q,onRefresh:ie,onStatusChange:se,onNotify:H})}],[Me,ue,$,k,j,P,Q,ie,se,ke,ve,$e,d,H,D,b,A]),qe=M.items.reduce((F,ee)=>F+(Number(ee.qty)||0),0);return z?React.createElement("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center"},React.createElement("div",{className:"text-center"},React.createElement("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),React.createElement("p",{className:"text-slate-600"},"Loading products..."))):React.createElement("div",{className:"min-h-screen bg-slate-50"},React.createElement(Ar),_&&React.createElement("div",{className:Z("fixed bottom-4 right-4 z-40 max-w-sm rounded-lg border px-4 py-3 text-sm shadow-lg backdrop-blur",_.type==="error"?"border-red-200 bg-red-50/90 text-red-700":_.type==="warning"?"border-amber-200 bg-amber-50/90 text-amber-800":"border-emerald-200 bg-emerald-50/90 text-emerald-700")},React.createElement("div",{className:"flex items-start gap-3"},React.createElement("span",{className:"flex-1 leading-snug"},_.message),React.createElement("button",{type:"button",onClick:()=>B(null),className:"text-xs font-medium uppercase tracking-wide text-slate-500 hover:text-slate-700"},"Dismiss"))),React.createElement(Cr,{onOpenCart:()=>{a.current=window.scrollY||0,g(!0)},search:r,setSearch:t,ownerMode:m,setOwnerMode:W,cartQty:qe,connectionStatus:O,allowOwnerToggle:Ke}),m?React.createElement(Sr,{views:ut,section:h,onSectionChange:d}):React.createElement(React.Fragment,null,React.createElement(Or),React.createElement(Pr,{active:o,setActive:n}),React.createElement(Br,{products:_e,onOpen:F=>{a.current=window.scrollY||0,i(F&&F.__edit&&F.product?F.product:F)}})),React.createElement(Mr,{product:u,onClose:()=>{i(null)},onAdd:M.add}),React.createElement(Ir,{open:E,onClose:()=>g(!1),cart:M}))}ReactDOM.createRoot(document.getElementById("root")).render(React.createElement($r))},Fa=w=>{const T=document.createElement("div");T.style.cssText="position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(15,23,42,0.9);z-index:9999;padding:24px;",T.innerHTML=`
          <div style="width:100%;max-width:420px;padding:32px;border-radius:16px;background:white;box-shadow:0 20px 45px rgba(15,23,42,0.35);font-family:system-ui,-apple-system,Segoe UI,sans-serif;">
            <h1 style="margin:0 0 12px;font-size:22px;font-weight:600;color:#111827;">Owner Access</h1>
            <p style="margin:0 0 16px;font-size:14px;color:#4B5563;">Sign in to manage the catalogue.</p>
            <form style="display:flex;flex-direction:column;gap:12px;">
              <input name="email" type="email" autocomplete="email" placeholder="Email" style="width:100%;border:1px solid #D1D5DB;border-radius:8px;padding:10px 12px;font-size:14px;" required />
              <input name="password" type="password" autocomplete="current-password" placeholder="Password" style="width:100%;border:1px solid #D1D5DB;border-radius:8px;padding:10px 12px;font-size:14px;" required />
              <div data-status style="min-height:18px;font-size:13px;color:#DC2626;"></div>
              <button type="submit" style="border:none;border-radius:8px;background:#4F46E5;color:white;padding:10px 12px;font-size:14px;font-weight:600;cursor:pointer;">Sign in</button>
              <button type="button" data-signout style="display:none;border:1px solid #D1D5DB;border-radius:8px;background:white;color:#111827;padding:10px 12px;font-size:14px;font-weight:600;cursor:pointer;">Sign out</button>
            </form>
            <p style="margin:16px 0 0;font-size:12px;color:#6B7280;line-height:1.4;">
              This page requires Supabase Auth + owner-only RLS. If you haven't yet, run <code>supabase-owner-rls.sql</code> in Supabase, then add your Auth user UUID to <code>public.owner_users</code>.
            </p>
          </div>
        `,document.body.appendChild(T);const le=T.querySelector("form"),J=T.querySelector("input[name=email]"),gt=T.querySelector("input[name=password]"),Ht=T.querySelector("[data-status]"),xt=T.querySelector("[data-signout]");J.focus();const Oe=Re=>{Ht.textContent=Re||""},zt=Re=>{const De=le.querySelector("button[type=submit]");De.disabled=Re,De.style.opacity=Re?"0.7":"1",De.textContent=Re?"Signing in...":"Sign in"};xt.addEventListener("click",async()=>{try{await w.auth.signOut()}catch(Re){}xt.style.display="none",Oe("Signed out.")}),le.addEventListener("submit",async Re=>{var De,Ge,at,ct;Re.preventDefault(),Oe(""),zt(!0);try{const Ke=String(J.value||"").trim(),qt=String(gt.value||""),{data:ht,error:St}=await w.auth.signInWithPassword({email:Ke,password:qt});if(St)throw St;const X=await ma(w);if(X===!0){T.remove(),ua();return}const He=((De=ht==null?void 0:ht.user)==null?void 0:De.id)||((ct=(at=(Ge=await w.auth.getUser())==null?void 0:Ge.data)==null?void 0:at.user)==null?void 0:ct.id);xt.style.display="block",Oe(X===!1?`Signed in, but not an owner. User ID: ${He||"(unknown)"}`:"Signed in, but owner check failed. Ensure public.is_owner() exists and you are listed in public.owner_users.")}catch(Ke){Oe((Ke==null?void 0:Ke.message)||"Sign-in failed.")}finally{zt(!1),gt.value=""}})};(async()=>{const w=Ta();if(!w){const T=document.createElement("div");T.style.cssText="position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(15,23,42,0.9);z-index:9999;padding:24px;",T.innerHTML=`
            <div style="width:100%;max-width:420px;padding:32px;border-radius:16px;background:white;box-shadow:0 20px 45px rgba(15,23,42,0.35);font-family:system-ui,-apple-system,Segoe UI,sans-serif;">
              <h1 style="margin:0 0 12px;font-size:22px;font-weight:600;color:#111827;">Owner Access</h1>
              <p style="margin:0;font-size:14px;color:#4B5563;">Supabase is not configured. Ensure <code>supabase-config.js</code> is present and loads before this page script.</p>
            </div>
          `,document.body.appendChild(T);return}try{const{data:T}=await w.auth.getSession();if(T==null?void 0:T.session){const J=await ma(w);if(J===!0){ua();return}if(J===!1)try{await w.auth.signOut()}catch(gt){}}}catch(T){}Fa(w)})()})();})();
